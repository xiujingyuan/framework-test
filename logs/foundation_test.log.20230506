2023-05-06 18:50:56 INFO log_info: #### 当前环境env=1，country=china，environment=test
2023-05-06 18:50:56 INFO log_info: 修改未分案的案件天数为99,sql=UPDATE debtor_arrears ar SET ar.late_days = 99 WHERE 1=1 AND NOT exists(SELECT 1 FROM mission m WHERE m.mission_asset_id = ar.asset_id AND (m.assigned_sys_user_id is NOT null OR m.assigned_group_id is NOT null))AND ar.inner_outer = 'inner' AND ar.status = 'repay' AND ar.asset_type='现金贷多期' AND ar.late_days BETWEEN 7 AND 7
2023-05-06 18:50:57 INFO log_info: connect to qsq_fox1 with port 3321
2023-05-06 18:50:57 INFO do_sql: {'db': 'qsq_fox1', 'sql request': "UPDATE debtor_arrears ar SET ar.late_days = 99 WHERE 1=1 AND NOT exists(SELECT 1 FROM mission m WHERE m.mission_asset_id = ar.asset_id AND (m.assigned_sys_user_id is NOT null OR m.assigned_group_id is NOT null))AND ar.inner_outer = 'inner' AND ar.status = 'repay' AND ar.asset_type='现金贷多期' AND ar.late_days BETWEEN 7 AND 7", 'sql time': 0.66}
2023-05-06 18:50:57 INFO do_sql: {'db': 'qsq_fox1', 'sql request': "SELECT su.id FROM asset_type_group a LEFT JOIN user_asset_type b ON b.asset_group_id = a.asset_group LEFT JOIN sys_user su ON b.sys_user_id = su.id LEFT JOIN sys_user_role d ON d.user_id = su.id LEFT JOIN sys_role ee ON d.role_id = ee.id WHERE asset_line_status = 1 AND a.asset_group_name IN ('自动化测试_IVR组') AND su.del_flag=0 AND ee.enname = 'urger'", 'sql time': 0.03}
2023-05-06 18:50:57 INFO do_sql: {'db': 'qsq_fox1', 'sql request': "select sys_user_name as name,assign_total_amount as bf_current_month_assigned_amount from bi.mission_assign_statistics where create_at between date_add(curdate(), interval - day(curdate()) + 1 day) and curdate() and type = 2 and sys_user_id in ('b7715d89b64d4395b202f9dfd91824c6')", 'sql time': 0.03}
2023-05-06 18:50:57 INFO do_sql: {'db': 'qsq_fox1', 'sql request': "select sys_user_name as name,assign_total_amount as bf_current_month_assigned_amount from bi.mission_assign_statistics where create_at between date_add(curdate(), interval - day(curdate()) + 1 day) and curdate() and type = 2 and sys_user_id in ('da84724df241409787b0b14abfcb21e9')", 'sql time': 0.08}
2023-05-06 18:50:57 INFO do_sql: {'db': 'qsq_fox1', 'sql request': "select sys_user_name as name,assign_total_amount as bf_current_month_assigned_amount from bi.mission_assign_statistics where create_at between date_add(curdate(), interval - day(curdate()) + 1 day) and curdate() and type = 2 and sys_user_id in ('cb5be7dbe5644972b5138a28e7201d5d')", 'sql time': 0.04}
2023-05-06 18:50:57 INFO do_sql: {'db': 'qsq_fox1', 'sql request': "SELECT count(*) as online_days FROM collect_attendance_dtl b LEFT JOIN sys_user su ON b.user_id = su.id LEFT JOIN sys_user_role d ON d.user_id = su.id LEFT JOIN sys_role ee ON d.role_id = ee.id WHERE b.attendance_status_flag = 1 AND su.del_flag=0 AND ee.enname = 'urger' and b.work_day >= date_add(curdate(), interval - day(curdate()) + 1 day) and b.work_day <= curdate() and su.name = '八四1' ", 'sql time': 0.07}
2023-05-06 18:50:57 INFO do_sql: {'db': 'qsq_fox1', 'sql request': "SELECT count(*) as online_days FROM collect_attendance_dtl b LEFT JOIN sys_user su ON b.user_id = su.id LEFT JOIN sys_user_role d ON d.user_id = su.id LEFT JOIN sys_role ee ON d.role_id = ee.id WHERE b.attendance_status_flag = 1 AND su.del_flag=0 AND ee.enname = 'urger' and b.work_day >= date_add(curdate(), interval - day(curdate()) + 1 day) and b.work_day <= curdate() and su.name = '八四2' ", 'sql time': 0.04}
2023-05-06 18:50:57 INFO do_sql: {'db': 'qsq_fox1', 'sql request': "SELECT count(*) as online_days FROM collect_attendance_dtl b LEFT JOIN sys_user su ON b.user_id = su.id LEFT JOIN sys_user_role d ON d.user_id = su.id LEFT JOIN sys_role ee ON d.role_id = ee.id WHERE b.attendance_status_flag = 1 AND su.del_flag=0 AND ee.enname = 'urger' and b.work_day >= date_add(curdate(), interval - day(curdate()) + 1 day) and b.work_day <= curdate() and su.name = '八四3' ", 'sql time': 0.03}
2023-05-06 18:50:57 INFO log_info: ### 1分案前 初始化当前已分案情况：pre_assigned_info=  name  bf_current_month_assigned_amount  online_days
0  八四1                         229580960            0
1  八四2                         229019937            0
2  八四3                         228788768            0
2023-05-06 18:50:57 INFO log_info: ### 2分案前 初始化当前已分案情况：pre_assigned_info=  name  ...  assigned_amount/online_days
0  八四1  ...                          0.0
1  八四2  ...                          0.0
2  八四3  ...                          0.0

[3 rows x 4 columns]
2023-05-06 18:50:57 INFO log_info: ### 3分案前 初始化当前已分案情况：pre_assigned_info=  name  ...  assigned_amount/online_days
0  八四1  ...                          0.0
1  八四2  ...                          0.0
2  八四3  ...                          0.0

[3 rows x 4 columns]
2023-05-06 18:50:57 INFO log_info: ### 4分案前 催员排序：expect_assigned_info=  name
0  八四1
1  八四2
2  八四3
2023-05-06 18:50:57 INFO log_info: 需要准备的债务数量=14
2023-05-06 18:50:57 INFO do_sql: {'db': 'qsq_fox1', 'sql request': " select ar.debtor_id from debtor_arrears ar where 1=1 and not exists( select 1 from mission m where m.mission_asset_id = ar.asset_id and(m.assigned_sys_user_id is not null or m.assigned_group_id is not null)) and ar.inner_outer = 'inner' and ar.status = 'repay' and ar.asset_type='现金贷多期' and ar.late_days between 7 and 7 and exists(select 1 from asset a where a.asset_id = ar.asset_id and a.asset_from_app = '草莓') and exists(select 1 from debtor_asset da left join asset_quality aq on da.asset_item_number = aq.asset_item_number where da.debtor_arrears_id = ar.id and aq.item_cust_flg = '新用户') and exists(select 1 from debtor_asset da left join c_card cc on da.asset_item_number = cc.asset_item_number where da.debtor_arrears_id = ar.id and cc.d3_level = 1)", 'sql time': 0.2}
2023-05-06 18:50:57 INFO log_info: 获取未分案债务数量,SQL= select ar.debtor_id from debtor_arrears ar where 1=1 and not exists( select 1 from mission m where m.mission_asset_id = ar.asset_id and(m.assigned_sys_user_id is not null or m.assigned_group_id is not null)) and ar.inner_outer = 'inner' and ar.status = 'repay' and ar.asset_type='现金贷多期' and ar.late_days between 7 and 7 and exists(select 1 from asset a where a.asset_id = ar.asset_id and a.asset_from_app = '草莓') and exists(select 1 from debtor_asset da left join asset_quality aq on da.asset_item_number = aq.asset_item_number where da.debtor_arrears_id = ar.id and aq.item_cust_flg = '新用户') and exists(select 1 from debtor_asset da left join c_card cc on da.asset_item_number = cc.asset_item_number where da.debtor_arrears_id = ar.id and cc.d3_level = 1)，unassigned_case_info=()
2023-05-06 18:50:57 INFO log_info: #### 当前未分案D1债务数：0
2023-05-06 18:51:00 INFO log_info: 数据尚未准备完成，等待中，等待时间：1
2023-05-06 18:51:00 INFO do_sql: {'db': 'qsq_fox1', 'sql request': " select ar.debtor_id from debtor_arrears ar where 1=1 and not exists( select 1 from mission m where m.mission_asset_id = ar.asset_id and(m.assigned_sys_user_id is not null or m.assigned_group_id is not null)) and ar.inner_outer = 'inner' and ar.status = 'repay' and ar.asset_type='现金贷多期' and ar.late_days between 7 and 7 and exists(select 1 from asset a where a.asset_id = ar.asset_id and a.asset_from_app = '草莓') and exists(select 1 from debtor_asset da left join asset_quality aq on da.asset_item_number = aq.asset_item_number where da.debtor_arrears_id = ar.id and aq.item_cust_flg = '新用户') and exists(select 1 from debtor_asset da left join c_card cc on da.asset_item_number = cc.asset_item_number where da.debtor_arrears_id = ar.id and cc.d3_level = 1)", 'sql time': 0.13}
2023-05-06 18:51:00 INFO log_info: 获取未分案债务数量,SQL= select ar.debtor_id from debtor_arrears ar where 1=1 and not exists( select 1 from mission m where m.mission_asset_id = ar.asset_id and(m.assigned_sys_user_id is not null or m.assigned_group_id is not null)) and ar.inner_outer = 'inner' and ar.status = 'repay' and ar.asset_type='现金贷多期' and ar.late_days between 7 and 7 and exists(select 1 from asset a where a.asset_id = ar.asset_id and a.asset_from_app = '草莓') and exists(select 1 from debtor_asset da left join asset_quality aq on da.asset_item_number = aq.asset_item_number where da.debtor_arrears_id = ar.id and aq.item_cust_flg = '新用户') and exists(select 1 from debtor_asset da left join c_card cc on da.asset_item_number = cc.asset_item_number where da.debtor_arrears_id = ar.id and cc.d3_level = 1)，unassigned_case_info=[{'debtor_id': 3342325}]
2023-05-06 18:51:00 INFO log_info: #### 当前未分案D1债务数：1
2023-05-06 18:51:02 INFO log_info: 数据尚未准备完成，等待中，等待时间：2
2023-05-06 18:51:02 INFO do_sql: {'db': 'qsq_fox1', 'sql request': " select ar.debtor_id from debtor_arrears ar where 1=1 and not exists( select 1 from mission m where m.mission_asset_id = ar.asset_id and(m.assigned_sys_user_id is not null or m.assigned_group_id is not null)) and ar.inner_outer = 'inner' and ar.status = 'repay' and ar.asset_type='现金贷多期' and ar.late_days between 7 and 7 and exists(select 1 from asset a where a.asset_id = ar.asset_id and a.asset_from_app = '草莓') and exists(select 1 from debtor_asset da left join asset_quality aq on da.asset_item_number = aq.asset_item_number where da.debtor_arrears_id = ar.id and aq.item_cust_flg = '新用户') and exists(select 1 from debtor_asset da left join c_card cc on da.asset_item_number = cc.asset_item_number where da.debtor_arrears_id = ar.id and cc.d3_level = 1)", 'sql time': 0.06}
2023-05-06 18:51:02 INFO log_info: 获取未分案债务数量,SQL= select ar.debtor_id from debtor_arrears ar where 1=1 and not exists( select 1 from mission m where m.mission_asset_id = ar.asset_id and(m.assigned_sys_user_id is not null or m.assigned_group_id is not null)) and ar.inner_outer = 'inner' and ar.status = 'repay' and ar.asset_type='现金贷多期' and ar.late_days between 7 and 7 and exists(select 1 from asset a where a.asset_id = ar.asset_id and a.asset_from_app = '草莓') and exists(select 1 from debtor_asset da left join asset_quality aq on da.asset_item_number = aq.asset_item_number where da.debtor_arrears_id = ar.id and aq.item_cust_flg = '新用户') and exists(select 1 from debtor_asset da left join c_card cc on da.asset_item_number = cc.asset_item_number where da.debtor_arrears_id = ar.id and cc.d3_level = 1)，unassigned_case_info=[{'debtor_id': 3342325}, {'debtor_id': 3342326}]
2023-05-06 18:51:02 INFO log_info: #### 当前未分案D1债务数：2
2023-05-06 18:51:04 INFO log_info: 数据尚未准备完成，等待中，等待时间：3
2023-05-06 18:51:05 INFO do_sql: {'db': 'qsq_fox1', 'sql request': " select ar.debtor_id from debtor_arrears ar where 1=1 and not exists( select 1 from mission m where m.mission_asset_id = ar.asset_id and(m.assigned_sys_user_id is not null or m.assigned_group_id is not null)) and ar.inner_outer = 'inner' and ar.status = 'repay' and ar.asset_type='现金贷多期' and ar.late_days between 7 and 7 and exists(select 1 from asset a where a.asset_id = ar.asset_id and a.asset_from_app = '草莓') and exists(select 1 from debtor_asset da left join asset_quality aq on da.asset_item_number = aq.asset_item_number where da.debtor_arrears_id = ar.id and aq.item_cust_flg = '新用户') and exists(select 1 from debtor_asset da left join c_card cc on da.asset_item_number = cc.asset_item_number where da.debtor_arrears_id = ar.id and cc.d3_level = 1)", 'sql time': 0.21}
2023-05-06 18:51:05 INFO log_info: 获取未分案债务数量,SQL= select ar.debtor_id from debtor_arrears ar where 1=1 and not exists( select 1 from mission m where m.mission_asset_id = ar.asset_id and(m.assigned_sys_user_id is not null or m.assigned_group_id is not null)) and ar.inner_outer = 'inner' and ar.status = 'repay' and ar.asset_type='现金贷多期' and ar.late_days between 7 and 7 and exists(select 1 from asset a where a.asset_id = ar.asset_id and a.asset_from_app = '草莓') and exists(select 1 from debtor_asset da left join asset_quality aq on da.asset_item_number = aq.asset_item_number where da.debtor_arrears_id = ar.id and aq.item_cust_flg = '新用户') and exists(select 1 from debtor_asset da left join c_card cc on da.asset_item_number = cc.asset_item_number where da.debtor_arrears_id = ar.id and cc.d3_level = 1)，unassigned_case_info=[{'debtor_id': 3342325}, {'debtor_id': 3342326}, {'debtor_id': 3342327}]
2023-05-06 18:51:05 INFO log_info: #### 当前未分案D1债务数：3
2023-05-06 18:51:07 INFO log_info: 数据尚未准备完成，等待中，等待时间：4
2023-05-06 18:51:07 INFO do_sql: {'db': 'qsq_fox1', 'sql request': " select ar.debtor_id from debtor_arrears ar where 1=1 and not exists( select 1 from mission m where m.mission_asset_id = ar.asset_id and(m.assigned_sys_user_id is not null or m.assigned_group_id is not null)) and ar.inner_outer = 'inner' and ar.status = 'repay' and ar.asset_type='现金贷多期' and ar.late_days between 7 and 7 and exists(select 1 from asset a where a.asset_id = ar.asset_id and a.asset_from_app = '草莓') and exists(select 1 from debtor_asset da left join asset_quality aq on da.asset_item_number = aq.asset_item_number where da.debtor_arrears_id = ar.id and aq.item_cust_flg = '新用户') and exists(select 1 from debtor_asset da left join c_card cc on da.asset_item_number = cc.asset_item_number where da.debtor_arrears_id = ar.id and cc.d3_level = 1)", 'sql time': 0.04}
2023-05-06 18:51:07 INFO log_info: 获取未分案债务数量,SQL= select ar.debtor_id from debtor_arrears ar where 1=1 and not exists( select 1 from mission m where m.mission_asset_id = ar.asset_id and(m.assigned_sys_user_id is not null or m.assigned_group_id is not null)) and ar.inner_outer = 'inner' and ar.status = 'repay' and ar.asset_type='现金贷多期' and ar.late_days between 7 and 7 and exists(select 1 from asset a where a.asset_id = ar.asset_id and a.asset_from_app = '草莓') and exists(select 1 from debtor_asset da left join asset_quality aq on da.asset_item_number = aq.asset_item_number where da.debtor_arrears_id = ar.id and aq.item_cust_flg = '新用户') and exists(select 1 from debtor_asset da left join c_card cc on da.asset_item_number = cc.asset_item_number where da.debtor_arrears_id = ar.id and cc.d3_level = 1)，unassigned_case_info=[{'debtor_id': 3342325}, {'debtor_id': 3342326}, {'debtor_id': 3342327}, {'debtor_id': 3342328}]
2023-05-06 18:51:07 INFO log_info: #### 当前未分案D1债务数：4
2023-05-06 18:51:10 INFO log_info: 数据尚未准备完成，等待中，等待时间：5
2023-05-06 18:51:10 INFO do_sql: {'db': 'qsq_fox1', 'sql request': " select ar.debtor_id from debtor_arrears ar where 1=1 and not exists( select 1 from mission m where m.mission_asset_id = ar.asset_id and(m.assigned_sys_user_id is not null or m.assigned_group_id is not null)) and ar.inner_outer = 'inner' and ar.status = 'repay' and ar.asset_type='现金贷多期' and ar.late_days between 7 and 7 and exists(select 1 from asset a where a.asset_id = ar.asset_id and a.asset_from_app = '草莓') and exists(select 1 from debtor_asset da left join asset_quality aq on da.asset_item_number = aq.asset_item_number where da.debtor_arrears_id = ar.id and aq.item_cust_flg = '新用户') and exists(select 1 from debtor_asset da left join c_card cc on da.asset_item_number = cc.asset_item_number where da.debtor_arrears_id = ar.id and cc.d3_level = 1)", 'sql time': 0.06}
2023-05-06 18:51:10 INFO log_info: 获取未分案债务数量,SQL= select ar.debtor_id from debtor_arrears ar where 1=1 and not exists( select 1 from mission m where m.mission_asset_id = ar.asset_id and(m.assigned_sys_user_id is not null or m.assigned_group_id is not null)) and ar.inner_outer = 'inner' and ar.status = 'repay' and ar.asset_type='现金贷多期' and ar.late_days between 7 and 7 and exists(select 1 from asset a where a.asset_id = ar.asset_id and a.asset_from_app = '草莓') and exists(select 1 from debtor_asset da left join asset_quality aq on da.asset_item_number = aq.asset_item_number where da.debtor_arrears_id = ar.id and aq.item_cust_flg = '新用户') and exists(select 1 from debtor_asset da left join c_card cc on da.asset_item_number = cc.asset_item_number where da.debtor_arrears_id = ar.id and cc.d3_level = 1)，unassigned_case_info=[{'debtor_id': 3342325}, {'debtor_id': 3342326}, {'debtor_id': 3342327}, {'debtor_id': 3342328}, {'debtor_id': 3342329}]
2023-05-06 18:51:10 INFO log_info: #### 当前未分案D1债务数：5
2023-05-06 18:51:13 INFO log_info: 数据尚未准备完成，等待中，等待时间：6
2023-05-06 18:51:14 INFO do_sql: {'db': 'qsq_fox1', 'sql request': " select ar.debtor_id from debtor_arrears ar where 1=1 and not exists( select 1 from mission m where m.mission_asset_id = ar.asset_id and(m.assigned_sys_user_id is not null or m.assigned_group_id is not null)) and ar.inner_outer = 'inner' and ar.status = 'repay' and ar.asset_type='现金贷多期' and ar.late_days between 7 and 7 and exists(select 1 from asset a where a.asset_id = ar.asset_id and a.asset_from_app = '草莓') and exists(select 1 from debtor_asset da left join asset_quality aq on da.asset_item_number = aq.asset_item_number where da.debtor_arrears_id = ar.id and aq.item_cust_flg = '新用户') and exists(select 1 from debtor_asset da left join c_card cc on da.asset_item_number = cc.asset_item_number where da.debtor_arrears_id = ar.id and cc.d3_level = 1)", 'sql time': 0.16}
2023-05-06 18:51:14 INFO log_info: 获取未分案债务数量,SQL= select ar.debtor_id from debtor_arrears ar where 1=1 and not exists( select 1 from mission m where m.mission_asset_id = ar.asset_id and(m.assigned_sys_user_id is not null or m.assigned_group_id is not null)) and ar.inner_outer = 'inner' and ar.status = 'repay' and ar.asset_type='现金贷多期' and ar.late_days between 7 and 7 and exists(select 1 from asset a where a.asset_id = ar.asset_id and a.asset_from_app = '草莓') and exists(select 1 from debtor_asset da left join asset_quality aq on da.asset_item_number = aq.asset_item_number where da.debtor_arrears_id = ar.id and aq.item_cust_flg = '新用户') and exists(select 1 from debtor_asset da left join c_card cc on da.asset_item_number = cc.asset_item_number where da.debtor_arrears_id = ar.id and cc.d3_level = 1)，unassigned_case_info=[{'debtor_id': 3342325}, {'debtor_id': 3342326}, {'debtor_id': 3342327}, {'debtor_id': 3342328}, {'debtor_id': 3342329}, {'debtor_id': 3342330}]
2023-05-06 18:51:14 INFO log_info: #### 当前未分案D1债务数：6
2023-05-06 18:51:16 INFO log_info: 数据尚未准备完成，等待中，等待时间：7
2023-05-06 18:51:16 INFO do_sql: {'db': 'qsq_fox1', 'sql request': " select ar.debtor_id from debtor_arrears ar where 1=1 and not exists( select 1 from mission m where m.mission_asset_id = ar.asset_id and(m.assigned_sys_user_id is not null or m.assigned_group_id is not null)) and ar.inner_outer = 'inner' and ar.status = 'repay' and ar.asset_type='现金贷多期' and ar.late_days between 7 and 7 and exists(select 1 from asset a where a.asset_id = ar.asset_id and a.asset_from_app = '草莓') and exists(select 1 from debtor_asset da left join asset_quality aq on da.asset_item_number = aq.asset_item_number where da.debtor_arrears_id = ar.id and aq.item_cust_flg = '新用户') and exists(select 1 from debtor_asset da left join c_card cc on da.asset_item_number = cc.asset_item_number where da.debtor_arrears_id = ar.id and cc.d3_level = 1)", 'sql time': 0.04}
2023-05-06 18:51:16 INFO log_info: 获取未分案债务数量,SQL= select ar.debtor_id from debtor_arrears ar where 1=1 and not exists( select 1 from mission m where m.mission_asset_id = ar.asset_id and(m.assigned_sys_user_id is not null or m.assigned_group_id is not null)) and ar.inner_outer = 'inner' and ar.status = 'repay' and ar.asset_type='现金贷多期' and ar.late_days between 7 and 7 and exists(select 1 from asset a where a.asset_id = ar.asset_id and a.asset_from_app = '草莓') and exists(select 1 from debtor_asset da left join asset_quality aq on da.asset_item_number = aq.asset_item_number where da.debtor_arrears_id = ar.id and aq.item_cust_flg = '新用户') and exists(select 1 from debtor_asset da left join c_card cc on da.asset_item_number = cc.asset_item_number where da.debtor_arrears_id = ar.id and cc.d3_level = 1)，unassigned_case_info=[{'debtor_id': 3342325}, {'debtor_id': 3342326}, {'debtor_id': 3342327}, {'debtor_id': 3342328}, {'debtor_id': 3342329}, {'debtor_id': 3342330}, {'debtor_id': 3342331}]
2023-05-06 18:51:16 INFO log_info: #### 当前未分案D1债务数：7
2023-05-06 18:51:18 INFO log_info: 数据尚未准备完成，等待中，等待时间：8
2023-05-06 18:51:18 INFO do_sql: {'db': 'qsq_fox1', 'sql request': " select ar.debtor_id from debtor_arrears ar where 1=1 and not exists( select 1 from mission m where m.mission_asset_id = ar.asset_id and(m.assigned_sys_user_id is not null or m.assigned_group_id is not null)) and ar.inner_outer = 'inner' and ar.status = 'repay' and ar.asset_type='现金贷多期' and ar.late_days between 7 and 7 and exists(select 1 from asset a where a.asset_id = ar.asset_id and a.asset_from_app = '草莓') and exists(select 1 from debtor_asset da left join asset_quality aq on da.asset_item_number = aq.asset_item_number where da.debtor_arrears_id = ar.id and aq.item_cust_flg = '新用户') and exists(select 1 from debtor_asset da left join c_card cc on da.asset_item_number = cc.asset_item_number where da.debtor_arrears_id = ar.id and cc.d3_level = 1)", 'sql time': 0.04}
2023-05-06 18:51:18 INFO log_info: 获取未分案债务数量,SQL= select ar.debtor_id from debtor_arrears ar where 1=1 and not exists( select 1 from mission m where m.mission_asset_id = ar.asset_id and(m.assigned_sys_user_id is not null or m.assigned_group_id is not null)) and ar.inner_outer = 'inner' and ar.status = 'repay' and ar.asset_type='现金贷多期' and ar.late_days between 7 and 7 and exists(select 1 from asset a where a.asset_id = ar.asset_id and a.asset_from_app = '草莓') and exists(select 1 from debtor_asset da left join asset_quality aq on da.asset_item_number = aq.asset_item_number where da.debtor_arrears_id = ar.id and aq.item_cust_flg = '新用户') and exists(select 1 from debtor_asset da left join c_card cc on da.asset_item_number = cc.asset_item_number where da.debtor_arrears_id = ar.id and cc.d3_level = 1)，unassigned_case_info=[{'debtor_id': 3342325}, {'debtor_id': 3342326}, {'debtor_id': 3342327}, {'debtor_id': 3342328}, {'debtor_id': 3342329}, {'debtor_id': 3342330}, {'debtor_id': 3342331}, {'debtor_id': 3342332}]
2023-05-06 18:51:18 INFO log_info: #### 当前未分案D1债务数：8
2023-05-06 18:51:21 INFO log_info: 数据尚未准备完成，等待中，等待时间：9
2023-05-06 18:51:21 INFO do_sql: {'db': 'qsq_fox1', 'sql request': " select ar.debtor_id from debtor_arrears ar where 1=1 and not exists( select 1 from mission m where m.mission_asset_id = ar.asset_id and(m.assigned_sys_user_id is not null or m.assigned_group_id is not null)) and ar.inner_outer = 'inner' and ar.status = 'repay' and ar.asset_type='现金贷多期' and ar.late_days between 7 and 7 and exists(select 1 from asset a where a.asset_id = ar.asset_id and a.asset_from_app = '草莓') and exists(select 1 from debtor_asset da left join asset_quality aq on da.asset_item_number = aq.asset_item_number where da.debtor_arrears_id = ar.id and aq.item_cust_flg = '新用户') and exists(select 1 from debtor_asset da left join c_card cc on da.asset_item_number = cc.asset_item_number where da.debtor_arrears_id = ar.id and cc.d3_level = 1)", 'sql time': 0.06}
2023-05-06 18:51:21 INFO log_info: 获取未分案债务数量,SQL= select ar.debtor_id from debtor_arrears ar where 1=1 and not exists( select 1 from mission m where m.mission_asset_id = ar.asset_id and(m.assigned_sys_user_id is not null or m.assigned_group_id is not null)) and ar.inner_outer = 'inner' and ar.status = 'repay' and ar.asset_type='现金贷多期' and ar.late_days between 7 and 7 and exists(select 1 from asset a where a.asset_id = ar.asset_id and a.asset_from_app = '草莓') and exists(select 1 from debtor_asset da left join asset_quality aq on da.asset_item_number = aq.asset_item_number where da.debtor_arrears_id = ar.id and aq.item_cust_flg = '新用户') and exists(select 1 from debtor_asset da left join c_card cc on da.asset_item_number = cc.asset_item_number where da.debtor_arrears_id = ar.id and cc.d3_level = 1)，unassigned_case_info=[{'debtor_id': 3342325}, {'debtor_id': 3342326}, {'debtor_id': 3342327}, {'debtor_id': 3342328}, {'debtor_id': 3342329}, {'debtor_id': 3342330}, {'debtor_id': 3342331}, {'debtor_id': 3342332}, {'debtor_id': 3342333}]
2023-05-06 18:51:21 INFO log_info: #### 当前未分案D1债务数：9
2023-05-06 18:51:24 INFO log_info: 数据尚未准备完成，等待中，等待时间：10
2023-05-06 18:51:24 INFO do_sql: {'db': 'qsq_fox1', 'sql request': " select ar.debtor_id from debtor_arrears ar where 1=1 and not exists( select 1 from mission m where m.mission_asset_id = ar.asset_id and(m.assigned_sys_user_id is not null or m.assigned_group_id is not null)) and ar.inner_outer = 'inner' and ar.status = 'repay' and ar.asset_type='现金贷多期' and ar.late_days between 7 and 7 and exists(select 1 from asset a where a.asset_id = ar.asset_id and a.asset_from_app = '草莓') and exists(select 1 from debtor_asset da left join asset_quality aq on da.asset_item_number = aq.asset_item_number where da.debtor_arrears_id = ar.id and aq.item_cust_flg = '新用户') and exists(select 1 from debtor_asset da left join c_card cc on da.asset_item_number = cc.asset_item_number where da.debtor_arrears_id = ar.id and cc.d3_level = 1)", 'sql time': 0.07}
2023-05-06 18:51:24 INFO log_info: 获取未分案债务数量,SQL= select ar.debtor_id from debtor_arrears ar where 1=1 and not exists( select 1 from mission m where m.mission_asset_id = ar.asset_id and(m.assigned_sys_user_id is not null or m.assigned_group_id is not null)) and ar.inner_outer = 'inner' and ar.status = 'repay' and ar.asset_type='现金贷多期' and ar.late_days between 7 and 7 and exists(select 1 from asset a where a.asset_id = ar.asset_id and a.asset_from_app = '草莓') and exists(select 1 from debtor_asset da left join asset_quality aq on da.asset_item_number = aq.asset_item_number where da.debtor_arrears_id = ar.id and aq.item_cust_flg = '新用户') and exists(select 1 from debtor_asset da left join c_card cc on da.asset_item_number = cc.asset_item_number where da.debtor_arrears_id = ar.id and cc.d3_level = 1)，unassigned_case_info=[{'debtor_id': 3342325}, {'debtor_id': 3342326}, {'debtor_id': 3342327}, {'debtor_id': 3342328}, {'debtor_id': 3342329}, {'debtor_id': 3342330}, {'debtor_id': 3342331}, {'debtor_id': 3342332}, {'debtor_id': 3342333}, {'debtor_id': 3342334}]
2023-05-06 18:51:24 INFO log_info: #### 当前未分案D1债务数：10
2023-05-06 18:51:26 INFO log_info: 数据尚未准备完成，等待中，等待时间：11
2023-05-06 18:51:26 INFO do_sql: {'db': 'qsq_fox1', 'sql request': " select ar.debtor_id from debtor_arrears ar where 1=1 and not exists( select 1 from mission m where m.mission_asset_id = ar.asset_id and(m.assigned_sys_user_id is not null or m.assigned_group_id is not null)) and ar.inner_outer = 'inner' and ar.status = 'repay' and ar.asset_type='现金贷多期' and ar.late_days between 7 and 7 and exists(select 1 from asset a where a.asset_id = ar.asset_id and a.asset_from_app = '草莓') and exists(select 1 from debtor_asset da left join asset_quality aq on da.asset_item_number = aq.asset_item_number where da.debtor_arrears_id = ar.id and aq.item_cust_flg = '新用户') and exists(select 1 from debtor_asset da left join c_card cc on da.asset_item_number = cc.asset_item_number where da.debtor_arrears_id = ar.id and cc.d3_level = 1)", 'sql time': 0.06}
2023-05-06 18:51:26 INFO log_info: 获取未分案债务数量,SQL= select ar.debtor_id from debtor_arrears ar where 1=1 and not exists( select 1 from mission m where m.mission_asset_id = ar.asset_id and(m.assigned_sys_user_id is not null or m.assigned_group_id is not null)) and ar.inner_outer = 'inner' and ar.status = 'repay' and ar.asset_type='现金贷多期' and ar.late_days between 7 and 7 and exists(select 1 from asset a where a.asset_id = ar.asset_id and a.asset_from_app = '草莓') and exists(select 1 from debtor_asset da left join asset_quality aq on da.asset_item_number = aq.asset_item_number where da.debtor_arrears_id = ar.id and aq.item_cust_flg = '新用户') and exists(select 1 from debtor_asset da left join c_card cc on da.asset_item_number = cc.asset_item_number where da.debtor_arrears_id = ar.id and cc.d3_level = 1)，unassigned_case_info=[{'debtor_id': 3342325}, {'debtor_id': 3342326}, {'debtor_id': 3342327}, {'debtor_id': 3342328}, {'debtor_id': 3342329}, {'debtor_id': 3342330}, {'debtor_id': 3342331}, {'debtor_id': 3342332}, {'debtor_id': 3342333}, {'debtor_id': 3342334}, {'debtor_id': 3342335}]
2023-05-06 18:51:26 INFO log_info: #### 当前未分案D1债务数：11
2023-05-06 18:51:28 INFO log_info: 数据尚未准备完成，等待中，等待时间：12
2023-05-06 18:51:29 INFO do_sql: {'db': 'qsq_fox1', 'sql request': " select ar.debtor_id from debtor_arrears ar where 1=1 and not exists( select 1 from mission m where m.mission_asset_id = ar.asset_id and(m.assigned_sys_user_id is not null or m.assigned_group_id is not null)) and ar.inner_outer = 'inner' and ar.status = 'repay' and ar.asset_type='现金贷多期' and ar.late_days between 7 and 7 and exists(select 1 from asset a where a.asset_id = ar.asset_id and a.asset_from_app = '草莓') and exists(select 1 from debtor_asset da left join asset_quality aq on da.asset_item_number = aq.asset_item_number where da.debtor_arrears_id = ar.id and aq.item_cust_flg = '新用户') and exists(select 1 from debtor_asset da left join c_card cc on da.asset_item_number = cc.asset_item_number where da.debtor_arrears_id = ar.id and cc.d3_level = 1)", 'sql time': 0.04}
2023-05-06 18:51:29 INFO log_info: 获取未分案债务数量,SQL= select ar.debtor_id from debtor_arrears ar where 1=1 and not exists( select 1 from mission m where m.mission_asset_id = ar.asset_id and(m.assigned_sys_user_id is not null or m.assigned_group_id is not null)) and ar.inner_outer = 'inner' and ar.status = 'repay' and ar.asset_type='现金贷多期' and ar.late_days between 7 and 7 and exists(select 1 from asset a where a.asset_id = ar.asset_id and a.asset_from_app = '草莓') and exists(select 1 from debtor_asset da left join asset_quality aq on da.asset_item_number = aq.asset_item_number where da.debtor_arrears_id = ar.id and aq.item_cust_flg = '新用户') and exists(select 1 from debtor_asset da left join c_card cc on da.asset_item_number = cc.asset_item_number where da.debtor_arrears_id = ar.id and cc.d3_level = 1)，unassigned_case_info=[{'debtor_id': 3342325}, {'debtor_id': 3342326}, {'debtor_id': 3342327}, {'debtor_id': 3342328}, {'debtor_id': 3342329}, {'debtor_id': 3342330}, {'debtor_id': 3342331}, {'debtor_id': 3342332}, {'debtor_id': 3342333}, {'debtor_id': 3342334}, {'debtor_id': 3342335}, {'debtor_id': 3342336}]
2023-05-06 18:51:29 INFO log_info: #### 当前未分案D1债务数：12
2023-05-06 18:51:31 INFO log_info: 数据尚未准备完成，等待中，等待时间：13
2023-05-06 18:51:31 INFO do_sql: {'db': 'qsq_fox1', 'sql request': " select ar.debtor_id from debtor_arrears ar where 1=1 and not exists( select 1 from mission m where m.mission_asset_id = ar.asset_id and(m.assigned_sys_user_id is not null or m.assigned_group_id is not null)) and ar.inner_outer = 'inner' and ar.status = 'repay' and ar.asset_type='现金贷多期' and ar.late_days between 7 and 7 and exists(select 1 from asset a where a.asset_id = ar.asset_id and a.asset_from_app = '草莓') and exists(select 1 from debtor_asset da left join asset_quality aq on da.asset_item_number = aq.asset_item_number where da.debtor_arrears_id = ar.id and aq.item_cust_flg = '新用户') and exists(select 1 from debtor_asset da left join c_card cc on da.asset_item_number = cc.asset_item_number where da.debtor_arrears_id = ar.id and cc.d3_level = 1)", 'sql time': 0.04}
2023-05-06 18:51:31 INFO log_info: 获取未分案债务数量,SQL= select ar.debtor_id from debtor_arrears ar where 1=1 and not exists( select 1 from mission m where m.mission_asset_id = ar.asset_id and(m.assigned_sys_user_id is not null or m.assigned_group_id is not null)) and ar.inner_outer = 'inner' and ar.status = 'repay' and ar.asset_type='现金贷多期' and ar.late_days between 7 and 7 and exists(select 1 from asset a where a.asset_id = ar.asset_id and a.asset_from_app = '草莓') and exists(select 1 from debtor_asset da left join asset_quality aq on da.asset_item_number = aq.asset_item_number where da.debtor_arrears_id = ar.id and aq.item_cust_flg = '新用户') and exists(select 1 from debtor_asset da left join c_card cc on da.asset_item_number = cc.asset_item_number where da.debtor_arrears_id = ar.id and cc.d3_level = 1)，unassigned_case_info=[{'debtor_id': 3342325}, {'debtor_id': 3342326}, {'debtor_id': 3342327}, {'debtor_id': 3342328}, {'debtor_id': 3342329}, {'debtor_id': 3342330}, {'debtor_id': 3342331}, {'debtor_id': 3342332}, {'debtor_id': 3342333}, {'debtor_id': 3342334}, {'debtor_id': 3342335}, {'debtor_id': 3342336}, {'debtor_id': 3342337}]
2023-05-06 18:51:31 INFO log_info: #### 当前未分案D1债务数：13
2023-05-06 18:51:34 INFO log_info: 数据尚未准备完成，等待中，等待时间：14
2023-05-06 18:51:34 INFO do_sql: {'db': 'qsq_fox1', 'sql request': " select ar.debtor_id from debtor_arrears ar where 1=1 and not exists( select 1 from mission m where m.mission_asset_id = ar.asset_id and(m.assigned_sys_user_id is not null or m.assigned_group_id is not null)) and ar.inner_outer = 'inner' and ar.status = 'repay' and ar.asset_type='现金贷多期' and ar.late_days between 7 and 7 and exists(select 1 from asset a where a.asset_id = ar.asset_id and a.asset_from_app = '草莓') and exists(select 1 from debtor_asset da left join asset_quality aq on da.asset_item_number = aq.asset_item_number where da.debtor_arrears_id = ar.id and aq.item_cust_flg = '新用户') and exists(select 1 from debtor_asset da left join c_card cc on da.asset_item_number = cc.asset_item_number where da.debtor_arrears_id = ar.id and cc.d3_level = 1)", 'sql time': 0.03}
2023-05-06 18:51:34 INFO log_info: 获取未分案债务数量,SQL= select ar.debtor_id from debtor_arrears ar where 1=1 and not exists( select 1 from mission m where m.mission_asset_id = ar.asset_id and(m.assigned_sys_user_id is not null or m.assigned_group_id is not null)) and ar.inner_outer = 'inner' and ar.status = 'repay' and ar.asset_type='现金贷多期' and ar.late_days between 7 and 7 and exists(select 1 from asset a where a.asset_id = ar.asset_id and a.asset_from_app = '草莓') and exists(select 1 from debtor_asset da left join asset_quality aq on da.asset_item_number = aq.asset_item_number where da.debtor_arrears_id = ar.id and aq.item_cust_flg = '新用户') and exists(select 1 from debtor_asset da left join c_card cc on da.asset_item_number = cc.asset_item_number where da.debtor_arrears_id = ar.id and cc.d3_level = 1)，unassigned_case_info=[{'debtor_id': 3342325}, {'debtor_id': 3342326}, {'debtor_id': 3342327}, {'debtor_id': 3342328}, {'debtor_id': 3342329}, {'debtor_id': 3342330}, {'debtor_id': 3342331}, {'debtor_id': 3342332}, {'debtor_id': 3342333}, {'debtor_id': 3342334}, {'debtor_id': 3342335}, {'debtor_id': 3342336}, {'debtor_id': 3342337}, {'debtor_id': 3342338}]
2023-05-06 18:51:34 INFO log_info: #### 当前未分案D1债务数：14
2023-05-06 18:51:34 INFO log_info: 数据准备成功，当前未分案D1债务数：14
2023-05-06 18:51:34 INFO do_sql: {'db': 'qsq_fox1', 'sql request': "update sys_session_log set stop_time = now() where sys_user_name = 'yxj' and active = 1 and stop_time is null and date_add(start_time, interval time_out/1000 second) > now()", 'sql time': 0.06}
2023-05-06 18:51:34 INFO do_sql: {'db': 'qsq_fox1', 'sql request': "select * from sys_session_log where sys_user_name = 'yxj' and active = 1 and stop_time is null and date_add(start_time, interval time_out/1000 second) > now() order by create_at desc limit 1", 'sql time': 0.04}
2023-05-06 18:51:35 INFO log_info: 登录中，等待时间：1
2023-05-06 18:51:35 INFO log_info: <Response [200]>
2023-05-06 18:51:35 INFO log_info: <Response [200]>
2023-05-06 18:51:35 INFO do_sql: {'db': 'qsq_fox1', 'sql request': "select * from sys_session_log where sys_user_name = 'yxj' and active = 1 and stop_time is null and date_add(start_time, interval time_out/1000 second) > now() order by create_at desc limit 1", 'sql time': 0.04}
2023-05-06 18:51:36 INFO log_info: 登录中，等待时间：2
2023-05-06 18:51:36 INFO log_info: <Response [200]>
2023-05-06 18:51:37 INFO log_info: <Response [200]>
2023-05-06 18:51:37 INFO do_sql: {'db': 'qsq_fox1', 'sql request': "select * from sys_session_log where sys_user_name = 'yxj' and active = 1 and stop_time is null and date_add(start_time, interval time_out/1000 second) > now() order by create_at desc limit 1", 'sql time': 0.04}
2023-05-06 18:51:38 INFO log_info: 登录中，等待时间：3
2023-05-06 18:51:38 INFO log_info: <Response [200]>
2023-05-06 18:51:38 INFO log_info: <Response [200]>
2023-05-06 18:51:38 INFO do_sql: {'db': 'qsq_fox1', 'sql request': "select * from sys_session_log where sys_user_name = 'yxj' and active = 1 and stop_time is null and date_add(start_time, interval time_out/1000 second) > now() order by create_at desc limit 1", 'sql time': 0.04}
2023-05-06 18:51:39 INFO log_info: 登录中，等待时间：4
2023-05-06 18:51:39 INFO log_info: <Response [200]>
2023-05-06 18:51:40 INFO log_info: <Response [200]>
2023-05-06 18:51:40 INFO do_sql: {'db': 'qsq_fox1', 'sql request': "select * from sys_session_log where sys_user_name = 'yxj' and active = 1 and stop_time is null and date_add(start_time, interval time_out/1000 second) > now() order by create_at desc limit 1", 'sql time': 0.03}
2023-05-06 18:51:41 INFO log_info: 登录中，等待时间：5
2023-05-06 18:51:41 INFO log_info: <Response [200]>
2023-05-06 18:51:41 INFO log_info: <Response [200]>
2023-05-06 18:51:41 INFO do_sql: {'db': 'qsq_fox1', 'sql request': "select * from sys_session_log where sys_user_name = 'yxj' and active = 1 and stop_time is null and date_add(start_time, interval time_out/1000 second) > now() order by create_at desc limit 1", 'sql time': 0.07}
2023-05-06 18:51:42 INFO log_info: 登录中，等待时间：6
2023-05-06 18:51:43 INFO log_info: <Response [200]>
2023-05-06 18:51:43 INFO log_info: <Response [200]>
2023-05-06 18:51:43 INFO do_sql: {'db': 'qsq_fox1', 'sql request': "select * from sys_session_log where sys_user_name = 'yxj' and active = 1 and stop_time is null and date_add(start_time, interval time_out/1000 second) > now() order by create_at desc limit 1", 'sql time': 0.04}
2023-05-06 18:51:44 INFO log_info: 登录中，等待时间：7
2023-05-06 18:51:44 INFO log_info: <Response [200]>
2023-05-06 18:51:44 INFO log_info: <Response [200]>
2023-05-06 18:51:44 INFO do_sql: {'db': 'qsq_fox1', 'sql request': "select * from sys_session_log where sys_user_name = 'yxj' and active = 1 and stop_time is null and date_add(start_time, interval time_out/1000 second) > now() order by create_at desc limit 1", 'sql time': 0.04}
2023-05-06 18:51:45 INFO log_info: 登录中，等待时间：8
2023-05-06 18:51:45 INFO log_info: <Response [200]>
2023-05-06 18:51:46 INFO log_info: <Response [200]>
2023-05-06 18:51:46 INFO do_sql: {'db': 'qsq_fox1', 'sql request': "select * from sys_session_log where sys_user_name = 'yxj' and active = 1 and stop_time is null and date_add(start_time, interval time_out/1000 second) > now() order by create_at desc limit 1", 'sql time': 0.03}
2023-05-06 18:51:47 INFO log_info: 登录中，等待时间：9
2023-05-06 18:51:47 INFO log_info: <Response [200]>
2023-05-06 18:51:47 INFO log_info: <Response [200]>
2023-05-06 18:51:47 INFO do_sql: {'db': 'qsq_fox1', 'sql request': "select * from sys_session_log where sys_user_name = 'yxj' and active = 1 and stop_time is null and date_add(start_time, interval time_out/1000 second) > now() order by create_at desc limit 1", 'sql time': 0.03}
2023-05-06 18:51:48 INFO log_info: 登录中，等待时间：10
2023-05-06 18:51:48 INFO log_info: <Response [200]>
2023-05-06 18:51:49 INFO log_info: <Response [200]>
2023-05-06 18:51:49 INFO do_sql: {'db': 'qsq_fox1', 'sql request': "select * from sys_session_log where sys_user_name = 'yxj' and active = 1 and stop_time is null and date_add(start_time, interval time_out/1000 second) > now() order by create_at desc limit 1", 'sql time': 0.03}
2023-05-06 18:51:50 INFO log_info: 登录中，等待时间：11
2023-05-06 18:51:50 INFO log_info: <Response [200]>
2023-05-06 18:51:50 INFO log_info: <Response [200]>
2023-05-06 18:51:50 INFO do_sql: {'db': 'qsq_fox1', 'sql request': "select * from sys_session_log where sys_user_name = 'yxj' and active = 1 and stop_time is null and date_add(start_time, interval time_out/1000 second) > now() order by create_at desc limit 1", 'sql time': 0.03}
2023-05-06 18:51:51 INFO log_info: 登录中，等待时间：12
2023-05-06 18:51:51 INFO log_info: <Response [200]>
2023-05-06 18:51:52 INFO log_info: <Response [200]>
2023-05-06 18:51:52 INFO do_sql: {'db': 'qsq_fox1', 'sql request': "select * from sys_session_log where sys_user_name = 'yxj' and active = 1 and stop_time is null and date_add(start_time, interval time_out/1000 second) > now() order by create_at desc limit 1", 'sql time': 0.07}
2023-05-06 18:51:53 INFO log_info: 登录中，等待时间：13
2023-05-06 18:51:53 INFO log_info: <Response [200]>
2023-05-06 18:51:53 INFO log_info: <Response [200]>
2023-05-06 18:51:53 INFO do_sql: {'db': 'qsq_fox1', 'sql request': "select * from sys_session_log where sys_user_name = 'yxj' and active = 1 and stop_time is null and date_add(start_time, interval time_out/1000 second) > now() order by create_at desc limit 1", 'sql time': 0.12}
2023-05-06 18:51:54 INFO log_info: 登录中，等待时间：14
2023-05-06 18:51:54 INFO log_info: <Response [200]>
2023-05-06 18:51:55 INFO log_info: <Response [200]>
2023-05-06 18:51:55 INFO do_sql: {'db': 'qsq_fox1', 'sql request': "select * from sys_session_log where sys_user_name = 'yxj' and active = 1 and stop_time is null and date_add(start_time, interval time_out/1000 second) > now() order by create_at desc limit 1", 'sql time': 0.04}
2023-05-06 18:51:56 INFO log_info: 登录中，等待时间：15
2023-05-06 18:51:56 INFO log_info: <Response [200]>
2023-05-06 18:51:56 INFO log_info: <Response [200]>
2023-05-06 18:51:56 INFO do_sql: {'db': 'qsq_fox1', 'sql request': "select * from sys_session_log where sys_user_name = 'yxj' and active = 1 and stop_time is null and date_add(start_time, interval time_out/1000 second) > now() order by create_at desc limit 1", 'sql time': 0.04}
2023-05-06 18:51:57 INFO log_info: 登录中，等待时间：16
2023-05-06 18:51:58 INFO log_info: <Response [200]>
2023-05-06 18:51:58 INFO log_info: <Response [200]>
2023-05-06 18:51:58 INFO do_sql: {'db': 'qsq_fox1', 'sql request': "select * from sys_session_log where sys_user_name = 'yxj' and active = 1 and stop_time is null and date_add(start_time, interval time_out/1000 second) > now() order by create_at desc limit 1", 'sql time': 0.03}
2023-05-06 18:51:59 INFO log_info: 登录中，等待时间：17
2023-05-06 18:51:59 INFO log_info: <Response [200]>
2023-05-06 18:51:59 INFO log_info: <Response [200]>
2023-05-06 18:51:59 INFO do_sql: {'db': 'qsq_fox1', 'sql request': "select * from sys_session_log where sys_user_name = 'yxj' and active = 1 and stop_time is null and date_add(start_time, interval time_out/1000 second) > now() order by create_at desc limit 1", 'sql time': 0.04}
2023-05-06 18:52:00 INFO log_info: 登录中，等待时间：18
2023-05-06 18:52:01 INFO log_info: <Response [200]>
2023-05-06 18:52:01 INFO log_info: <Response [200]>
2023-05-06 18:52:01 INFO do_sql: {'db': 'qsq_fox1', 'sql request': "select * from sys_session_log where sys_user_name = 'yxj' and active = 1 and stop_time is null and date_add(start_time, interval time_out/1000 second) > now() order by create_at desc limit 1", 'sql time': 0.12}
2023-05-06 18:52:02 INFO log_info: 登录中，等待时间：19
2023-05-06 18:52:02 INFO log_info: <Response [200]>
2023-05-06 18:52:03 INFO log_info: <Response [200]>
2023-05-06 18:52:03 INFO do_sql: {'db': 'qsq_fox1', 'sql request': "select * from sys_session_log where sys_user_name = 'yxj' and active = 1 and stop_time is null and date_add(start_time, interval time_out/1000 second) > now() order by create_at desc limit 1", 'sql time': 0.14}
2023-05-06 18:52:04 INFO log_info: 登录中，等待时间：20
2023-05-06 18:52:04 INFO log_info: <Response [200]>
2023-05-06 18:52:04 INFO log_info: <Response [200]>
2023-05-06 18:52:04 INFO do_sql: {'db': 'qsq_fox1', 'sql request': "select * from sys_session_log where sys_user_name = 'yxj' and active = 1 and stop_time is null and date_add(start_time, interval time_out/1000 second) > now() order by create_at desc limit 1", 'sql time': 0.11}
2023-05-06 18:52:06 INFO log_info: 登录中，等待时间：21
2023-05-06 18:52:06 INFO log_info: <Response [200]>
2023-05-06 18:52:06 INFO log_info: <Response [200]>
2023-05-06 18:52:06 INFO do_sql: {'db': 'qsq_fox1', 'sql request': "select * from sys_session_log where sys_user_name = 'yxj' and active = 1 and stop_time is null and date_add(start_time, interval time_out/1000 second) > now() order by create_at desc limit 1", 'sql time': 0.03}
2023-05-06 18:52:07 INFO log_info: 登录中，等待时间：22
2023-05-06 18:52:07 INFO log_info: <Response [200]>
2023-05-06 18:52:07 INFO log_info: <Response [200]>
2023-05-06 18:52:08 INFO do_sql: {'db': 'qsq_fox1', 'sql request': "select * from sys_session_log where sys_user_name = 'yxj' and active = 1 and stop_time is null and date_add(start_time, interval time_out/1000 second) > now() order by create_at desc limit 1", 'sql time': 0.43}
2023-05-06 18:52:09 INFO log_info: 登录中，等待时间：23
2023-05-06 18:52:09 INFO log_info: <Response [200]>
2023-05-06 18:52:09 INFO log_info: <Response [200]>
2023-05-06 18:52:09 INFO do_sql: {'db': 'qsq_fox1', 'sql request': "select * from sys_session_log where sys_user_name = 'yxj' and active = 1 and stop_time is null and date_add(start_time, interval time_out/1000 second) > now() order by create_at desc limit 1", 'sql time': 0.04}
2023-05-06 18:52:11 INFO log_info: 登录中，等待时间：24
2023-05-06 18:52:11 INFO log_info: <Response [200]>
2023-05-06 18:52:11 INFO log_info: <Response [200]>
2023-05-06 18:52:11 INFO do_sql: {'db': 'qsq_fox1', 'sql request': "select * from sys_session_log where sys_user_name = 'yxj' and active = 1 and stop_time is null and date_add(start_time, interval time_out/1000 second) > now() order by create_at desc limit 1", 'sql time': 0.08}
2023-05-06 18:52:12 INFO log_info: 登录中，等待时间：25
2023-05-06 18:52:12 INFO log_info: <Response [200]>
2023-05-06 18:52:13 INFO log_info: <Response [200]>
2023-05-06 18:52:13 INFO do_sql: {'db': 'qsq_fox1', 'sql request': "select * from sys_session_log where sys_user_name = 'yxj' and active = 1 and stop_time is null and date_add(start_time, interval time_out/1000 second) > now() order by create_at desc limit 1", 'sql time': 0.07}
2023-05-06 18:52:14 INFO log_info: 登录中，等待时间：26
2023-05-06 18:52:14 INFO log_info: <Response [200]>
2023-05-06 18:52:14 INFO log_info: <Response [200]>
2023-05-06 18:52:14 INFO do_sql: {'db': 'qsq_fox1', 'sql request': "select * from sys_session_log where sys_user_name = 'yxj' and active = 1 and stop_time is null and date_add(start_time, interval time_out/1000 second) > now() order by create_at desc limit 1", 'sql time': 0.04}
2023-05-06 18:52:15 INFO log_info: 登录中，等待时间：27
2023-05-06 18:52:16 INFO log_info: <Response [200]>
2023-05-06 18:52:16 INFO log_info: <Response [200]>
2023-05-06 18:52:16 INFO do_sql: {'db': 'qsq_fox1', 'sql request': "select * from sys_session_log where sys_user_name = 'yxj' and active = 1 and stop_time is null and date_add(start_time, interval time_out/1000 second) > now() order by create_at desc limit 1", 'sql time': 0.26}
2023-05-06 18:52:17 INFO log_info: 登录中，等待时间：28
2023-05-06 18:52:17 INFO log_info: <Response [200]>
2023-05-06 18:52:17 INFO log_info: <Response [200]>
2023-05-06 18:52:18 INFO do_sql: {'db': 'qsq_fox1', 'sql request': "select * from sys_session_log where sys_user_name = 'yxj' and active = 1 and stop_time is null and date_add(start_time, interval time_out/1000 second) > now() order by create_at desc limit 1", 'sql time': 0.1}
2023-05-06 18:52:19 INFO log_info: 登录中，等待时间：29
2023-05-06 18:52:19 INFO log_info: <Response [200]>
2023-05-06 18:52:19 INFO log_info: <Response [200]>
2023-05-06 18:52:19 INFO do_sql: {'db': 'qsq_fox1', 'sql request': "select * from sys_session_log where sys_user_name = 'yxj' and active = 1 and stop_time is null and date_add(start_time, interval time_out/1000 second) > now() order by create_at desc limit 1", 'sql time': 0.06}
2023-05-06 18:52:20 INFO log_info: 登录中，等待时间：30
2023-05-06 18:52:20 INFO log_info: <Response [200]>
2023-05-06 18:52:21 INFO log_info: <Response [200]>
2023-05-06 18:52:21 INFO do_sql: {'db': 'qsq_fox1', 'sql request': "select * from sys_session_log where sys_user_name = 'yxj' and active = 1 and stop_time is null and date_add(start_time, interval time_out/1000 second) > now() order by create_at desc limit 1", 'sql time': 0.04}
2023-05-06 18:52:22 INFO log_info: 登录中，等待时间：31
2023-05-06 18:52:22 INFO log_info: <Response [200]>
2023-05-06 18:52:22 INFO log_info: <Response [200]>
2023-05-06 18:52:22 INFO do_sql: {'db': 'qsq_fox1', 'sql request': "select * from sys_session_log where sys_user_name = 'yxj' and active = 1 and stop_time is null and date_add(start_time, interval time_out/1000 second) > now() order by create_at desc limit 1", 'sql time': 0.04}
2023-05-06 18:52:23 INFO log_info: 登录中，等待时间：32
2023-05-06 18:52:23 INFO log_info: <Response [200]>
2023-05-06 18:52:24 INFO log_info: <Response [200]>
2023-05-06 18:52:24 INFO do_sql: {'db': 'qsq_fox1', 'sql request': "select * from sys_session_log where sys_user_name = 'yxj' and active = 1 and stop_time is null and date_add(start_time, interval time_out/1000 second) > now() order by create_at desc limit 1", 'sql time': 0.04}
2023-05-06 18:52:25 INFO log_info: 登录中，等待时间：33
2023-05-06 18:52:25 INFO log_info: <Response [200]>
2023-05-06 18:52:25 INFO log_info: <Response [200]>
2023-05-06 18:52:25 INFO do_sql: {'db': 'qsq_fox1', 'sql request': "select * from sys_session_log where sys_user_name = 'yxj' and active = 1 and stop_time is null and date_add(start_time, interval time_out/1000 second) > now() order by create_at desc limit 1", 'sql time': 0.25}
2023-05-06 18:52:27 INFO log_info: 登录中，等待时间：34
2023-05-06 18:52:27 INFO log_info: <Response [200]>
2023-05-06 18:52:27 INFO log_info: <Response [200]>
2023-05-06 18:52:27 INFO do_sql: {'db': 'qsq_fox1', 'sql request': "select * from sys_session_log where sys_user_name = 'yxj' and active = 1 and stop_time is null and date_add(start_time, interval time_out/1000 second) > now() order by create_at desc limit 1", 'sql time': 0.03}
2023-05-06 18:52:28 INFO log_info: 登录中，等待时间：35
2023-05-06 18:52:28 INFO log_info: <Response [200]>
2023-05-06 18:52:28 INFO log_info: <Response [200]>
2023-05-06 18:52:28 INFO do_sql: {'db': 'qsq_fox1', 'sql request': "select * from sys_session_log where sys_user_name = 'yxj' and active = 1 and stop_time is null and date_add(start_time, interval time_out/1000 second) > now() order by create_at desc limit 1", 'sql time': 0.04}
2023-05-06 18:52:29 INFO log_info: 登录中，等待时间：36
2023-05-06 18:52:29 INFO log_info: <Response [200]>
2023-05-06 18:52:30 INFO log_info: <Response [200]>
2023-05-06 18:52:30 INFO do_sql: {'db': 'qsq_fox1', 'sql request': "select * from sys_session_log where sys_user_name = 'yxj' and active = 1 and stop_time is null and date_add(start_time, interval time_out/1000 second) > now() order by create_at desc limit 1", 'sql time': 0.14}
2023-05-06 18:52:31 INFO log_info: 登录中，等待时间：37
2023-05-06 18:52:31 INFO log_info: <Response [200]>
2023-05-06 18:52:31 INFO log_info: <Response [200]>
2023-05-06 18:52:31 INFO do_sql: {'db': 'qsq_fox1', 'sql request': "select * from sys_session_log where sys_user_name = 'yxj' and active = 1 and stop_time is null and date_add(start_time, interval time_out/1000 second) > now() order by create_at desc limit 1", 'sql time': 0.04}
2023-05-06 18:52:32 INFO log_info: 登录中，等待时间：38
2023-05-06 18:52:33 INFO log_info: <Response [200]>
2023-05-06 18:52:33 INFO log_info: <Response [200]>
2023-05-06 18:52:33 INFO do_sql: {'db': 'qsq_fox1', 'sql request': "select * from sys_session_log where sys_user_name = 'yxj' and active = 1 and stop_time is null and date_add(start_time, interval time_out/1000 second) > now() order by create_at desc limit 1", 'sql time': 0.07}
2023-05-06 18:52:34 INFO log_info: 登录中，等待时间：39
2023-05-06 18:52:34 INFO log_info: <Response [200]>
2023-05-06 18:52:34 INFO log_info: <Response [200]>
2023-05-06 18:52:34 INFO do_sql: {'db': 'qsq_fox1', 'sql request': "select * from sys_session_log where sys_user_name = 'yxj' and active = 1 and stop_time is null and date_add(start_time, interval time_out/1000 second) > now() order by create_at desc limit 1", 'sql time': 0.06}
2023-05-06 18:52:35 INFO log_info: 登录中，等待时间：40
2023-05-06 18:52:35 INFO log_info: <Response [200]>
2023-05-06 18:52:36 INFO log_info: <Response [200]>
2023-05-06 18:52:36 INFO do_sql: {'db': 'qsq_fox1', 'sql request': "select * from sys_session_log where sys_user_name = 'yxj' and active = 1 and stop_time is null and date_add(start_time, interval time_out/1000 second) > now() order by create_at desc limit 1", 'sql time': 0.03}
2023-05-06 18:52:37 INFO log_info: 登录中，等待时间：41
2023-05-06 18:52:37 INFO log_info: <Response [200]>
2023-05-06 18:52:37 INFO log_info: <Response [200]>
2023-05-06 18:52:37 INFO do_sql: {'db': 'qsq_fox1', 'sql request': "select * from sys_session_log where sys_user_name = 'yxj' and active = 1 and stop_time is null and date_add(start_time, interval time_out/1000 second) > now() order by create_at desc limit 1", 'sql time': 0.13}
2023-05-06 18:52:38 INFO log_info: 登录中，等待时间：42
2023-05-06 18:52:39 INFO log_info: <Response [200]>
2023-05-06 18:52:39 INFO log_info: <Response [200]>
2023-05-06 18:52:39 INFO do_sql: {'db': 'qsq_fox1', 'sql request': "select * from sys_session_log where sys_user_name = 'yxj' and active = 1 and stop_time is null and date_add(start_time, interval time_out/1000 second) > now() order by create_at desc limit 1", 'sql time': 0.04}
2023-05-06 18:52:40 INFO log_info: 登录中，等待时间：43
2023-05-06 18:52:40 INFO log_info: <Response [200]>
2023-05-06 18:52:40 INFO log_info: <Response [200]>
2023-05-06 18:52:40 INFO do_sql: {'db': 'qsq_fox1', 'sql request': "select * from sys_session_log where sys_user_name = 'yxj' and active = 1 and stop_time is null and date_add(start_time, interval time_out/1000 second) > now() order by create_at desc limit 1", 'sql time': 0.04}
2023-05-06 18:52:41 INFO log_info: 登录中，等待时间：44
2023-05-06 18:52:42 INFO log_info: <Response [200]>
2023-05-06 18:52:42 INFO log_info: <Response [200]>
2023-05-06 18:52:42 INFO do_sql: {'db': 'qsq_fox1', 'sql request': "select * from sys_session_log where sys_user_name = 'yxj' and active = 1 and stop_time is null and date_add(start_time, interval time_out/1000 second) > now() order by create_at desc limit 1", 'sql time': 0.16}
2023-05-06 18:52:43 INFO log_info: 登录中，等待时间：45
2023-05-06 18:52:43 INFO log_info: <Response [200]>
2023-05-06 18:52:44 INFO log_info: <Response [200]>
2023-05-06 18:52:44 INFO do_sql: {'db': 'qsq_fox1', 'sql request': "select * from sys_session_log where sys_user_name = 'yxj' and active = 1 and stop_time is null and date_add(start_time, interval time_out/1000 second) > now() order by create_at desc limit 1", 'sql time': 0.13}
2023-05-06 18:52:45 INFO log_info: 登录中，等待时间：46
2023-05-06 18:52:45 INFO log_info: <Response [200]>
2023-05-06 18:52:45 INFO log_info: <Response [200]>
2023-05-06 18:52:45 INFO do_sql: {'db': 'qsq_fox1', 'sql request': "select * from sys_session_log where sys_user_name = 'yxj' and active = 1 and stop_time is null and date_add(start_time, interval time_out/1000 second) > now() order by create_at desc limit 1", 'sql time': 0.03}
2023-05-06 18:52:46 INFO log_info: 登录中，等待时间：47
2023-05-06 18:52:46 INFO log_info: <Response [200]>
2023-05-06 18:52:47 INFO log_info: <Response [200]>
2023-05-06 18:52:47 INFO do_sql: {'db': 'qsq_fox1', 'sql request': "select * from sys_session_log where sys_user_name = 'yxj' and active = 1 and stop_time is null and date_add(start_time, interval time_out/1000 second) > now() order by create_at desc limit 1", 'sql time': 0.18}
2023-05-06 18:52:48 INFO log_info: 登录中，等待时间：48
2023-05-06 18:52:48 INFO log_info: <Response [200]>
2023-05-06 18:52:48 INFO log_info: <Response [200]>
2023-05-06 18:52:49 INFO do_sql: {'db': 'qsq_fox1', 'sql request': "select * from sys_session_log where sys_user_name = 'yxj' and active = 1 and stop_time is null and date_add(start_time, interval time_out/1000 second) > now() order by create_at desc limit 1", 'sql time': 0.32}
2023-05-06 18:52:50 INFO log_info: 登录中，等待时间：49
2023-05-06 18:52:50 INFO log_info: <Response [200]>
2023-05-06 18:52:50 INFO log_info: <Response [200]>
2023-05-06 18:52:50 INFO do_sql: {'db': 'qsq_fox1', 'sql request': "select * from sys_session_log where sys_user_name = 'yxj' and active = 1 and stop_time is null and date_add(start_time, interval time_out/1000 second) > now() order by create_at desc limit 1", 'sql time': 0.06}
2023-05-06 18:52:51 INFO log_info: 登录中，等待时间：50
2023-05-06 18:52:51 INFO log_info: <Response [200]>
2023-05-06 18:52:52 INFO log_info: <Response [200]>
2023-05-06 18:52:52 INFO do_sql: {'db': 'qsq_fox1', 'sql request': "select * from sys_session_log where sys_user_name = 'yxj' and active = 1 and stop_time is null and date_add(start_time, interval time_out/1000 second) > now() order by create_at desc limit 1", 'sql time': 0.03}
2023-05-06 18:52:53 INFO log_info: 登录中，等待时间：51
2023-05-06 18:52:53 INFO log_info: <Response [200]>
2023-05-06 18:52:53 INFO log_info: <Response [200]>
2023-05-06 18:52:53 INFO do_sql: {'db': 'qsq_fox1', 'sql request': "select * from sys_session_log where sys_user_name = 'yxj' and active = 1 and stop_time is null and date_add(start_time, interval time_out/1000 second) > now() order by create_at desc limit 1", 'sql time': 0.04}
2023-05-06 18:52:54 INFO log_info: 登录中，等待时间：52
2023-05-06 18:52:54 INFO log_info: <Response [200]>
2023-05-06 18:52:55 INFO log_info: <Response [200]>
2023-05-06 18:52:55 INFO do_sql: {'db': 'qsq_fox1', 'sql request': "select * from sys_session_log where sys_user_name = 'yxj' and active = 1 and stop_time is null and date_add(start_time, interval time_out/1000 second) > now() order by create_at desc limit 1", 'sql time': 0.06}
2023-05-06 18:52:56 INFO log_info: 登录中，等待时间：53
2023-05-06 18:52:56 INFO log_info: <Response [200]>
2023-05-06 18:52:56 INFO log_info: <Response [200]>
2023-05-06 18:52:56 INFO do_sql: {'db': 'qsq_fox1', 'sql request': "select * from sys_session_log where sys_user_name = 'yxj' and active = 1 and stop_time is null and date_add(start_time, interval time_out/1000 second) > now() order by create_at desc limit 1", 'sql time': 0.13}
2023-05-06 18:52:57 INFO log_info: 登录中，等待时间：54
2023-05-06 18:52:57 INFO log_info: <Response [200]>
2023-05-06 18:52:58 INFO log_info: <Response [200]>
2023-05-06 18:52:58 INFO do_sql: {'db': 'qsq_fox1', 'sql request': "select * from sys_session_log where sys_user_name = 'yxj' and active = 1 and stop_time is null and date_add(start_time, interval time_out/1000 second) > now() order by create_at desc limit 1", 'sql time': 0.04}
2023-05-06 18:52:59 INFO log_info: 登录中，等待时间：55
2023-05-06 18:52:59 INFO log_info: <Response [200]>
2023-05-06 18:52:59 INFO log_info: <Response [200]>
2023-05-06 18:52:59 INFO do_sql: {'db': 'qsq_fox1', 'sql request': "select * from sys_session_log where sys_user_name = 'yxj' and active = 1 and stop_time is null and date_add(start_time, interval time_out/1000 second) > now() order by create_at desc limit 1", 'sql time': 0.06}
2023-05-06 18:53:00 INFO log_info: 登录中，等待时间：56
2023-05-06 18:53:00 INFO log_info: <Response [200]>
2023-05-06 18:53:01 INFO log_info: <Response [200]>
2023-05-06 18:53:01 INFO do_sql: {'db': 'qsq_fox1', 'sql request': "select * from sys_session_log where sys_user_name = 'yxj' and active = 1 and stop_time is null and date_add(start_time, interval time_out/1000 second) > now() order by create_at desc limit 1", 'sql time': 0.05}
2023-05-06 18:53:02 INFO log_info: 登录中，等待时间：57
2023-05-06 18:53:02 INFO log_info: <Response [200]>
2023-05-06 18:53:02 INFO log_info: <Response [200]>
2023-05-06 18:53:02 INFO do_sql: {'db': 'qsq_fox1', 'sql request': "select * from sys_session_log where sys_user_name = 'yxj' and active = 1 and stop_time is null and date_add(start_time, interval time_out/1000 second) > now() order by create_at desc limit 1", 'sql time': 0.03}
2023-05-06 18:53:03 INFO log_info: 登录中，等待时间：58
2023-05-06 18:53:04 INFO log_info: <Response [200]>
2023-05-06 18:53:04 INFO log_info: <Response [200]>
2023-05-06 18:53:04 INFO do_sql: {'db': 'qsq_fox1', 'sql request': "select * from sys_session_log where sys_user_name = 'yxj' and active = 1 and stop_time is null and date_add(start_time, interval time_out/1000 second) > now() order by create_at desc limit 1", 'sql time': 0.04}
2023-05-06 18:53:05 INFO log_info: 登录中，等待时间：59
2023-05-06 18:53:05 INFO log_info: <Response [200]>
2023-05-06 18:53:05 INFO log_info: <Response [200]>
2023-05-06 18:53:05 INFO do_sql: {'db': 'qsq_fox1', 'sql request': "select * from sys_session_log where sys_user_name = 'yxj' and active = 1 and stop_time is null and date_add(start_time, interval time_out/1000 second) > now() order by create_at desc limit 1", 'sql time': 0.03}
2023-05-06 18:53:06 INFO log_info: 登录中，等待时间：60
2023-05-06 18:53:06 INFO log_info: <Response [200]>
2023-05-06 18:53:07 INFO log_info: <Response [200]>
2023-05-06 18:53:07 INFO close_connects: 关闭数据库链接：qsq_fox1
2023-05-06 18:55:38 INFO log_info: #### 当前环境env=1，country=china，environment=test
2023-05-06 18:55:38 INFO log_info: 修改未分案的案件天数为99,sql=UPDATE debtor_arrears ar SET ar.late_days = 99 WHERE 1=1 AND NOT exists(SELECT 1 FROM mission m WHERE m.mission_asset_id = ar.asset_id AND (m.assigned_sys_user_id is NOT null OR m.assigned_group_id is NOT null))AND ar.inner_outer = 'inner' AND ar.status = 'repay' AND ar.asset_type='现金贷多期' AND ar.late_days BETWEEN 7 AND 7
2023-05-06 18:55:38 INFO log_info: connect to qsq_fox1 with port 3321
2023-05-06 18:55:38 INFO do_sql: {'db': 'qsq_fox1', 'sql request': "UPDATE debtor_arrears ar SET ar.late_days = 99 WHERE 1=1 AND NOT exists(SELECT 1 FROM mission m WHERE m.mission_asset_id = ar.asset_id AND (m.assigned_sys_user_id is NOT null OR m.assigned_group_id is NOT null))AND ar.inner_outer = 'inner' AND ar.status = 'repay' AND ar.asset_type='现金贷多期' AND ar.late_days BETWEEN 7 AND 7", 'sql time': 0.83}
2023-05-06 18:55:38 INFO do_sql: {'db': 'qsq_fox1', 'sql request': "SELECT su.id FROM asset_type_group a LEFT JOIN user_asset_type b ON b.asset_group_id = a.asset_group LEFT JOIN sys_user su ON b.sys_user_id = su.id LEFT JOIN sys_user_role d ON d.user_id = su.id LEFT JOIN sys_role ee ON d.role_id = ee.id WHERE asset_line_status = 1 AND a.asset_group_name IN ('自动化测试_IVR组') AND su.del_flag=0 AND ee.enname = 'urger'", 'sql time': 0.04}
2023-05-06 18:55:38 INFO do_sql: {'db': 'qsq_fox1', 'sql request': "select sys_user_name as name,assign_total_amount as bf_current_month_assigned_amount from bi.mission_assign_statistics where create_at between date_add(curdate(), interval - day(curdate()) + 1 day) and curdate() and type = 2 and sys_user_id in ('b7715d89b64d4395b202f9dfd91824c6')", 'sql time': 0.07}
2023-05-06 18:55:39 INFO do_sql: {'db': 'qsq_fox1', 'sql request': "select sys_user_name as name,assign_total_amount as bf_current_month_assigned_amount from bi.mission_assign_statistics where create_at between date_add(curdate(), interval - day(curdate()) + 1 day) and curdate() and type = 2 and sys_user_id in ('da84724df241409787b0b14abfcb21e9')", 'sql time': 0.03}
2023-05-06 18:55:39 INFO do_sql: {'db': 'qsq_fox1', 'sql request': "select sys_user_name as name,assign_total_amount as bf_current_month_assigned_amount from bi.mission_assign_statistics where create_at between date_add(curdate(), interval - day(curdate()) + 1 day) and curdate() and type = 2 and sys_user_id in ('cb5be7dbe5644972b5138a28e7201d5d')", 'sql time': 0.05}
2023-05-06 18:55:39 INFO do_sql: {'db': 'qsq_fox1', 'sql request': "SELECT count(*) as online_days FROM collect_attendance_dtl b LEFT JOIN sys_user su ON b.user_id = su.id LEFT JOIN sys_user_role d ON d.user_id = su.id LEFT JOIN sys_role ee ON d.role_id = ee.id WHERE b.attendance_status_flag = 1 AND su.del_flag=0 AND ee.enname = 'urger' and b.work_day >= date_add(curdate(), interval - day(curdate()) + 1 day) and b.work_day <= curdate() and su.name = '八四1' ", 'sql time': 0.15}
2023-05-06 18:55:39 INFO do_sql: {'db': 'qsq_fox1', 'sql request': "SELECT count(*) as online_days FROM collect_attendance_dtl b LEFT JOIN sys_user su ON b.user_id = su.id LEFT JOIN sys_user_role d ON d.user_id = su.id LEFT JOIN sys_role ee ON d.role_id = ee.id WHERE b.attendance_status_flag = 1 AND su.del_flag=0 AND ee.enname = 'urger' and b.work_day >= date_add(curdate(), interval - day(curdate()) + 1 day) and b.work_day <= curdate() and su.name = '八四2' ", 'sql time': 0.04}
2023-05-06 18:55:39 INFO do_sql: {'db': 'qsq_fox1', 'sql request': "SELECT count(*) as online_days FROM collect_attendance_dtl b LEFT JOIN sys_user su ON b.user_id = su.id LEFT JOIN sys_user_role d ON d.user_id = su.id LEFT JOIN sys_role ee ON d.role_id = ee.id WHERE b.attendance_status_flag = 1 AND su.del_flag=0 AND ee.enname = 'urger' and b.work_day >= date_add(curdate(), interval - day(curdate()) + 1 day) and b.work_day <= curdate() and su.name = '八四3' ", 'sql time': 0.09}
2023-05-06 18:55:39 INFO log_info: ### 1分案前 初始化当前已分案情况：pre_assigned_info=  name  bf_current_month_assigned_amount  online_days
0  八四1                         229580960            0
1  八四2                         229019937            0
2  八四3                         228788768            0
2023-05-06 18:55:39 INFO log_info: ### 2分案前 初始化当前已分案情况：pre_assigned_info=  name  ...  assigned_amount/online_days
0  八四1  ...                          0.0
1  八四2  ...                          0.0
2  八四3  ...                          0.0

[3 rows x 4 columns]
2023-05-06 18:55:39 INFO log_info: ### 3分案前 初始化当前已分案情况：pre_assigned_info=  name  ...  assigned_amount/online_days
0  八四1  ...                          0.0
1  八四2  ...                          0.0
2  八四3  ...                          0.0

[3 rows x 4 columns]
2023-05-06 18:55:39 INFO log_info: ### 4分案前 催员排序：expect_assigned_info=  name
0  八四1
1  八四2
2  八四3
2023-05-06 18:55:39 INFO log_info: 需要准备的债务数量=14
2023-05-06 18:55:39 INFO do_sql: {'db': 'qsq_fox1', 'sql request': " select ar.debtor_id from debtor_arrears ar where 1=1 and not exists( select 1 from mission m where m.mission_asset_id = ar.asset_id and(m.assigned_sys_user_id is not null or m.assigned_group_id is not null)) and ar.inner_outer = 'inner' and ar.status = 'repay' and ar.asset_type='现金贷多期' and ar.late_days between 7 and 7 and exists(select 1 from asset a where a.asset_id = ar.asset_id and a.asset_from_app = '草莓') and exists(select 1 from debtor_asset da left join asset_quality aq on da.asset_item_number = aq.asset_item_number where da.debtor_arrears_id = ar.id and aq.item_cust_flg = '新用户') and exists(select 1 from debtor_asset da left join c_card cc on da.asset_item_number = cc.asset_item_number where da.debtor_arrears_id = ar.id and cc.d3_level = 1)", 'sql time': 0.07}
2023-05-06 18:55:39 INFO log_info: 获取未分案债务数量,SQL= select ar.debtor_id from debtor_arrears ar where 1=1 and not exists( select 1 from mission m where m.mission_asset_id = ar.asset_id and(m.assigned_sys_user_id is not null or m.assigned_group_id is not null)) and ar.inner_outer = 'inner' and ar.status = 'repay' and ar.asset_type='现金贷多期' and ar.late_days between 7 and 7 and exists(select 1 from asset a where a.asset_id = ar.asset_id and a.asset_from_app = '草莓') and exists(select 1 from debtor_asset da left join asset_quality aq on da.asset_item_number = aq.asset_item_number where da.debtor_arrears_id = ar.id and aq.item_cust_flg = '新用户') and exists(select 1 from debtor_asset da left join c_card cc on da.asset_item_number = cc.asset_item_number where da.debtor_arrears_id = ar.id and cc.d3_level = 1)，unassigned_case_info=()
2023-05-06 18:55:39 INFO log_info: #### 当前未分案D1债务数：0
2023-05-06 18:55:42 INFO log_info: 数据尚未准备完成，等待中，等待时间：1
2023-05-06 18:55:42 INFO do_sql: {'db': 'qsq_fox1', 'sql request': " select ar.debtor_id from debtor_arrears ar where 1=1 and not exists( select 1 from mission m where m.mission_asset_id = ar.asset_id and(m.assigned_sys_user_id is not null or m.assigned_group_id is not null)) and ar.inner_outer = 'inner' and ar.status = 'repay' and ar.asset_type='现金贷多期' and ar.late_days between 7 and 7 and exists(select 1 from asset a where a.asset_id = ar.asset_id and a.asset_from_app = '草莓') and exists(select 1 from debtor_asset da left join asset_quality aq on da.asset_item_number = aq.asset_item_number where da.debtor_arrears_id = ar.id and aq.item_cust_flg = '新用户') and exists(select 1 from debtor_asset da left join c_card cc on da.asset_item_number = cc.asset_item_number where da.debtor_arrears_id = ar.id and cc.d3_level = 1)", 'sql time': 0.04}
2023-05-06 18:55:42 INFO log_info: 获取未分案债务数量,SQL= select ar.debtor_id from debtor_arrears ar where 1=1 and not exists( select 1 from mission m where m.mission_asset_id = ar.asset_id and(m.assigned_sys_user_id is not null or m.assigned_group_id is not null)) and ar.inner_outer = 'inner' and ar.status = 'repay' and ar.asset_type='现金贷多期' and ar.late_days between 7 and 7 and exists(select 1 from asset a where a.asset_id = ar.asset_id and a.asset_from_app = '草莓') and exists(select 1 from debtor_asset da left join asset_quality aq on da.asset_item_number = aq.asset_item_number where da.debtor_arrears_id = ar.id and aq.item_cust_flg = '新用户') and exists(select 1 from debtor_asset da left join c_card cc on da.asset_item_number = cc.asset_item_number where da.debtor_arrears_id = ar.id and cc.d3_level = 1)，unassigned_case_info=[{'debtor_id': 3342339}]
2023-05-06 18:55:42 INFO log_info: #### 当前未分案D1债务数：1
2023-05-06 18:55:44 INFO log_info: 数据尚未准备完成，等待中，等待时间：2
2023-05-06 18:55:44 INFO do_sql: {'db': 'qsq_fox1', 'sql request': " select ar.debtor_id from debtor_arrears ar where 1=1 and not exists( select 1 from mission m where m.mission_asset_id = ar.asset_id and(m.assigned_sys_user_id is not null or m.assigned_group_id is not null)) and ar.inner_outer = 'inner' and ar.status = 'repay' and ar.asset_type='现金贷多期' and ar.late_days between 7 and 7 and exists(select 1 from asset a where a.asset_id = ar.asset_id and a.asset_from_app = '草莓') and exists(select 1 from debtor_asset da left join asset_quality aq on da.asset_item_number = aq.asset_item_number where da.debtor_arrears_id = ar.id and aq.item_cust_flg = '新用户') and exists(select 1 from debtor_asset da left join c_card cc on da.asset_item_number = cc.asset_item_number where da.debtor_arrears_id = ar.id and cc.d3_level = 1)", 'sql time': 0.04}
2023-05-06 18:55:44 INFO log_info: 获取未分案债务数量,SQL= select ar.debtor_id from debtor_arrears ar where 1=1 and not exists( select 1 from mission m where m.mission_asset_id = ar.asset_id and(m.assigned_sys_user_id is not null or m.assigned_group_id is not null)) and ar.inner_outer = 'inner' and ar.status = 'repay' and ar.asset_type='现金贷多期' and ar.late_days between 7 and 7 and exists(select 1 from asset a where a.asset_id = ar.asset_id and a.asset_from_app = '草莓') and exists(select 1 from debtor_asset da left join asset_quality aq on da.asset_item_number = aq.asset_item_number where da.debtor_arrears_id = ar.id and aq.item_cust_flg = '新用户') and exists(select 1 from debtor_asset da left join c_card cc on da.asset_item_number = cc.asset_item_number where da.debtor_arrears_id = ar.id and cc.d3_level = 1)，unassigned_case_info=[{'debtor_id': 3342339}, {'debtor_id': 3342340}]
2023-05-06 18:55:44 INFO log_info: #### 当前未分案D1债务数：2
2023-05-06 18:55:46 INFO log_info: 数据尚未准备完成，等待中，等待时间：3
2023-05-06 18:55:46 INFO do_sql: {'db': 'qsq_fox1', 'sql request': " select ar.debtor_id from debtor_arrears ar where 1=1 and not exists( select 1 from mission m where m.mission_asset_id = ar.asset_id and(m.assigned_sys_user_id is not null or m.assigned_group_id is not null)) and ar.inner_outer = 'inner' and ar.status = 'repay' and ar.asset_type='现金贷多期' and ar.late_days between 7 and 7 and exists(select 1 from asset a where a.asset_id = ar.asset_id and a.asset_from_app = '草莓') and exists(select 1 from debtor_asset da left join asset_quality aq on da.asset_item_number = aq.asset_item_number where da.debtor_arrears_id = ar.id and aq.item_cust_flg = '新用户') and exists(select 1 from debtor_asset da left join c_card cc on da.asset_item_number = cc.asset_item_number where da.debtor_arrears_id = ar.id and cc.d3_level = 1)", 'sql time': 0.04}
2023-05-06 18:55:46 INFO log_info: 获取未分案债务数量,SQL= select ar.debtor_id from debtor_arrears ar where 1=1 and not exists( select 1 from mission m where m.mission_asset_id = ar.asset_id and(m.assigned_sys_user_id is not null or m.assigned_group_id is not null)) and ar.inner_outer = 'inner' and ar.status = 'repay' and ar.asset_type='现金贷多期' and ar.late_days between 7 and 7 and exists(select 1 from asset a where a.asset_id = ar.asset_id and a.asset_from_app = '草莓') and exists(select 1 from debtor_asset da left join asset_quality aq on da.asset_item_number = aq.asset_item_number where da.debtor_arrears_id = ar.id and aq.item_cust_flg = '新用户') and exists(select 1 from debtor_asset da left join c_card cc on da.asset_item_number = cc.asset_item_number where da.debtor_arrears_id = ar.id and cc.d3_level = 1)，unassigned_case_info=[{'debtor_id': 3342339}, {'debtor_id': 3342340}, {'debtor_id': 3342341}]
2023-05-06 18:55:46 INFO log_info: #### 当前未分案D1债务数：3
2023-05-06 18:55:48 INFO log_info: 数据尚未准备完成，等待中，等待时间：4
2023-05-06 18:55:49 INFO do_sql: {'db': 'qsq_fox1', 'sql request': " select ar.debtor_id from debtor_arrears ar where 1=1 and not exists( select 1 from mission m where m.mission_asset_id = ar.asset_id and(m.assigned_sys_user_id is not null or m.assigned_group_id is not null)) and ar.inner_outer = 'inner' and ar.status = 'repay' and ar.asset_type='现金贷多期' and ar.late_days between 7 and 7 and exists(select 1 from asset a where a.asset_id = ar.asset_id and a.asset_from_app = '草莓') and exists(select 1 from debtor_asset da left join asset_quality aq on da.asset_item_number = aq.asset_item_number where da.debtor_arrears_id = ar.id and aq.item_cust_flg = '新用户') and exists(select 1 from debtor_asset da left join c_card cc on da.asset_item_number = cc.asset_item_number where da.debtor_arrears_id = ar.id and cc.d3_level = 1)", 'sql time': 0.04}
2023-05-06 18:55:49 INFO log_info: 获取未分案债务数量,SQL= select ar.debtor_id from debtor_arrears ar where 1=1 and not exists( select 1 from mission m where m.mission_asset_id = ar.asset_id and(m.assigned_sys_user_id is not null or m.assigned_group_id is not null)) and ar.inner_outer = 'inner' and ar.status = 'repay' and ar.asset_type='现金贷多期' and ar.late_days between 7 and 7 and exists(select 1 from asset a where a.asset_id = ar.asset_id and a.asset_from_app = '草莓') and exists(select 1 from debtor_asset da left join asset_quality aq on da.asset_item_number = aq.asset_item_number where da.debtor_arrears_id = ar.id and aq.item_cust_flg = '新用户') and exists(select 1 from debtor_asset da left join c_card cc on da.asset_item_number = cc.asset_item_number where da.debtor_arrears_id = ar.id and cc.d3_level = 1)，unassigned_case_info=[{'debtor_id': 3342339}, {'debtor_id': 3342340}, {'debtor_id': 3342341}, {'debtor_id': 3342342}]
2023-05-06 18:55:49 INFO log_info: #### 当前未分案D1债务数：4
2023-05-06 18:55:51 INFO log_info: 数据尚未准备完成，等待中，等待时间：5
2023-05-06 18:55:51 INFO do_sql: {'db': 'qsq_fox1', 'sql request': " select ar.debtor_id from debtor_arrears ar where 1=1 and not exists( select 1 from mission m where m.mission_asset_id = ar.asset_id and(m.assigned_sys_user_id is not null or m.assigned_group_id is not null)) and ar.inner_outer = 'inner' and ar.status = 'repay' and ar.asset_type='现金贷多期' and ar.late_days between 7 and 7 and exists(select 1 from asset a where a.asset_id = ar.asset_id and a.asset_from_app = '草莓') and exists(select 1 from debtor_asset da left join asset_quality aq on da.asset_item_number = aq.asset_item_number where da.debtor_arrears_id = ar.id and aq.item_cust_flg = '新用户') and exists(select 1 from debtor_asset da left join c_card cc on da.asset_item_number = cc.asset_item_number where da.debtor_arrears_id = ar.id and cc.d3_level = 1)", 'sql time': 0.04}
2023-05-06 18:55:51 INFO log_info: 获取未分案债务数量,SQL= select ar.debtor_id from debtor_arrears ar where 1=1 and not exists( select 1 from mission m where m.mission_asset_id = ar.asset_id and(m.assigned_sys_user_id is not null or m.assigned_group_id is not null)) and ar.inner_outer = 'inner' and ar.status = 'repay' and ar.asset_type='现金贷多期' and ar.late_days between 7 and 7 and exists(select 1 from asset a where a.asset_id = ar.asset_id and a.asset_from_app = '草莓') and exists(select 1 from debtor_asset da left join asset_quality aq on da.asset_item_number = aq.asset_item_number where da.debtor_arrears_id = ar.id and aq.item_cust_flg = '新用户') and exists(select 1 from debtor_asset da left join c_card cc on da.asset_item_number = cc.asset_item_number where da.debtor_arrears_id = ar.id and cc.d3_level = 1)，unassigned_case_info=[{'debtor_id': 3342339}, {'debtor_id': 3342340}, {'debtor_id': 3342341}, {'debtor_id': 3342342}, {'debtor_id': 3342343}]
2023-05-06 18:55:51 INFO log_info: #### 当前未分案D1债务数：5
2023-05-06 18:55:53 INFO log_info: 数据尚未准备完成，等待中，等待时间：6
2023-05-06 18:55:53 INFO do_sql: {'db': 'qsq_fox1', 'sql request': " select ar.debtor_id from debtor_arrears ar where 1=1 and not exists( select 1 from mission m where m.mission_asset_id = ar.asset_id and(m.assigned_sys_user_id is not null or m.assigned_group_id is not null)) and ar.inner_outer = 'inner' and ar.status = 'repay' and ar.asset_type='现金贷多期' and ar.late_days between 7 and 7 and exists(select 1 from asset a where a.asset_id = ar.asset_id and a.asset_from_app = '草莓') and exists(select 1 from debtor_asset da left join asset_quality aq on da.asset_item_number = aq.asset_item_number where da.debtor_arrears_id = ar.id and aq.item_cust_flg = '新用户') and exists(select 1 from debtor_asset da left join c_card cc on da.asset_item_number = cc.asset_item_number where da.debtor_arrears_id = ar.id and cc.d3_level = 1)", 'sql time': 0.04}
2023-05-06 18:55:53 INFO log_info: 获取未分案债务数量,SQL= select ar.debtor_id from debtor_arrears ar where 1=1 and not exists( select 1 from mission m where m.mission_asset_id = ar.asset_id and(m.assigned_sys_user_id is not null or m.assigned_group_id is not null)) and ar.inner_outer = 'inner' and ar.status = 'repay' and ar.asset_type='现金贷多期' and ar.late_days between 7 and 7 and exists(select 1 from asset a where a.asset_id = ar.asset_id and a.asset_from_app = '草莓') and exists(select 1 from debtor_asset da left join asset_quality aq on da.asset_item_number = aq.asset_item_number where da.debtor_arrears_id = ar.id and aq.item_cust_flg = '新用户') and exists(select 1 from debtor_asset da left join c_card cc on da.asset_item_number = cc.asset_item_number where da.debtor_arrears_id = ar.id and cc.d3_level = 1)，unassigned_case_info=[{'debtor_id': 3342339}, {'debtor_id': 3342340}, {'debtor_id': 3342341}, {'debtor_id': 3342342}, {'debtor_id': 3342343}, {'debtor_id': 3342344}]
2023-05-06 18:55:53 INFO log_info: #### 当前未分案D1债务数：6
2023-05-06 18:55:56 INFO log_info: 数据尚未准备完成，等待中，等待时间：7
2023-05-06 18:55:56 INFO do_sql: {'db': 'qsq_fox1', 'sql request': " select ar.debtor_id from debtor_arrears ar where 1=1 and not exists( select 1 from mission m where m.mission_asset_id = ar.asset_id and(m.assigned_sys_user_id is not null or m.assigned_group_id is not null)) and ar.inner_outer = 'inner' and ar.status = 'repay' and ar.asset_type='现金贷多期' and ar.late_days between 7 and 7 and exists(select 1 from asset a where a.asset_id = ar.asset_id and a.asset_from_app = '草莓') and exists(select 1 from debtor_asset da left join asset_quality aq on da.asset_item_number = aq.asset_item_number where da.debtor_arrears_id = ar.id and aq.item_cust_flg = '新用户') and exists(select 1 from debtor_asset da left join c_card cc on da.asset_item_number = cc.asset_item_number where da.debtor_arrears_id = ar.id and cc.d3_level = 1)", 'sql time': 0.04}
2023-05-06 18:55:56 INFO log_info: 获取未分案债务数量,SQL= select ar.debtor_id from debtor_arrears ar where 1=1 and not exists( select 1 from mission m where m.mission_asset_id = ar.asset_id and(m.assigned_sys_user_id is not null or m.assigned_group_id is not null)) and ar.inner_outer = 'inner' and ar.status = 'repay' and ar.asset_type='现金贷多期' and ar.late_days between 7 and 7 and exists(select 1 from asset a where a.asset_id = ar.asset_id and a.asset_from_app = '草莓') and exists(select 1 from debtor_asset da left join asset_quality aq on da.asset_item_number = aq.asset_item_number where da.debtor_arrears_id = ar.id and aq.item_cust_flg = '新用户') and exists(select 1 from debtor_asset da left join c_card cc on da.asset_item_number = cc.asset_item_number where da.debtor_arrears_id = ar.id and cc.d3_level = 1)，unassigned_case_info=[{'debtor_id': 3342339}, {'debtor_id': 3342340}, {'debtor_id': 3342341}, {'debtor_id': 3342342}, {'debtor_id': 3342343}, {'debtor_id': 3342344}, {'debtor_id': 3342345}]
2023-05-06 18:55:56 INFO log_info: #### 当前未分案D1债务数：7
2023-05-06 18:55:58 INFO log_info: 数据尚未准备完成，等待中，等待时间：8
2023-05-06 18:55:58 INFO do_sql: {'db': 'qsq_fox1', 'sql request': " select ar.debtor_id from debtor_arrears ar where 1=1 and not exists( select 1 from mission m where m.mission_asset_id = ar.asset_id and(m.assigned_sys_user_id is not null or m.assigned_group_id is not null)) and ar.inner_outer = 'inner' and ar.status = 'repay' and ar.asset_type='现金贷多期' and ar.late_days between 7 and 7 and exists(select 1 from asset a where a.asset_id = ar.asset_id and a.asset_from_app = '草莓') and exists(select 1 from debtor_asset da left join asset_quality aq on da.asset_item_number = aq.asset_item_number where da.debtor_arrears_id = ar.id and aq.item_cust_flg = '新用户') and exists(select 1 from debtor_asset da left join c_card cc on da.asset_item_number = cc.asset_item_number where da.debtor_arrears_id = ar.id and cc.d3_level = 1)", 'sql time': 0.04}
2023-05-06 18:55:58 INFO log_info: 获取未分案债务数量,SQL= select ar.debtor_id from debtor_arrears ar where 1=1 and not exists( select 1 from mission m where m.mission_asset_id = ar.asset_id and(m.assigned_sys_user_id is not null or m.assigned_group_id is not null)) and ar.inner_outer = 'inner' and ar.status = 'repay' and ar.asset_type='现金贷多期' and ar.late_days between 7 and 7 and exists(select 1 from asset a where a.asset_id = ar.asset_id and a.asset_from_app = '草莓') and exists(select 1 from debtor_asset da left join asset_quality aq on da.asset_item_number = aq.asset_item_number where da.debtor_arrears_id = ar.id and aq.item_cust_flg = '新用户') and exists(select 1 from debtor_asset da left join c_card cc on da.asset_item_number = cc.asset_item_number where da.debtor_arrears_id = ar.id and cc.d3_level = 1)，unassigned_case_info=[{'debtor_id': 3342339}, {'debtor_id': 3342340}, {'debtor_id': 3342341}, {'debtor_id': 3342342}, {'debtor_id': 3342343}, {'debtor_id': 3342344}, {'debtor_id': 3342345}, {'debtor_id': 3342346}]
2023-05-06 18:55:58 INFO log_info: #### 当前未分案D1债务数：8
2023-05-06 18:56:01 INFO log_info: 数据尚未准备完成，等待中，等待时间：9
2023-05-06 18:56:01 INFO do_sql: {'db': 'qsq_fox1', 'sql request': " select ar.debtor_id from debtor_arrears ar where 1=1 and not exists( select 1 from mission m where m.mission_asset_id = ar.asset_id and(m.assigned_sys_user_id is not null or m.assigned_group_id is not null)) and ar.inner_outer = 'inner' and ar.status = 'repay' and ar.asset_type='现金贷多期' and ar.late_days between 7 and 7 and exists(select 1 from asset a where a.asset_id = ar.asset_id and a.asset_from_app = '草莓') and exists(select 1 from debtor_asset da left join asset_quality aq on da.asset_item_number = aq.asset_item_number where da.debtor_arrears_id = ar.id and aq.item_cust_flg = '新用户') and exists(select 1 from debtor_asset da left join c_card cc on da.asset_item_number = cc.asset_item_number where da.debtor_arrears_id = ar.id and cc.d3_level = 1)", 'sql time': 0.04}
2023-05-06 18:56:01 INFO log_info: 获取未分案债务数量,SQL= select ar.debtor_id from debtor_arrears ar where 1=1 and not exists( select 1 from mission m where m.mission_asset_id = ar.asset_id and(m.assigned_sys_user_id is not null or m.assigned_group_id is not null)) and ar.inner_outer = 'inner' and ar.status = 'repay' and ar.asset_type='现金贷多期' and ar.late_days between 7 and 7 and exists(select 1 from asset a where a.asset_id = ar.asset_id and a.asset_from_app = '草莓') and exists(select 1 from debtor_asset da left join asset_quality aq on da.asset_item_number = aq.asset_item_number where da.debtor_arrears_id = ar.id and aq.item_cust_flg = '新用户') and exists(select 1 from debtor_asset da left join c_card cc on da.asset_item_number = cc.asset_item_number where da.debtor_arrears_id = ar.id and cc.d3_level = 1)，unassigned_case_info=[{'debtor_id': 3342339}, {'debtor_id': 3342340}, {'debtor_id': 3342341}, {'debtor_id': 3342342}, {'debtor_id': 3342343}, {'debtor_id': 3342344}, {'debtor_id': 3342345}, {'debtor_id': 3342346}, {'debtor_id': 3342347}]
2023-05-06 18:56:01 INFO log_info: #### 当前未分案D1债务数：9
2023-05-06 18:56:03 INFO log_info: 数据尚未准备完成，等待中，等待时间：10
2023-05-06 18:56:03 INFO do_sql: {'db': 'qsq_fox1', 'sql request': " select ar.debtor_id from debtor_arrears ar where 1=1 and not exists( select 1 from mission m where m.mission_asset_id = ar.asset_id and(m.assigned_sys_user_id is not null or m.assigned_group_id is not null)) and ar.inner_outer = 'inner' and ar.status = 'repay' and ar.asset_type='现金贷多期' and ar.late_days between 7 and 7 and exists(select 1 from asset a where a.asset_id = ar.asset_id and a.asset_from_app = '草莓') and exists(select 1 from debtor_asset da left join asset_quality aq on da.asset_item_number = aq.asset_item_number where da.debtor_arrears_id = ar.id and aq.item_cust_flg = '新用户') and exists(select 1 from debtor_asset da left join c_card cc on da.asset_item_number = cc.asset_item_number where da.debtor_arrears_id = ar.id and cc.d3_level = 1)", 'sql time': 0.04}
2023-05-06 18:56:03 INFO log_info: 获取未分案债务数量,SQL= select ar.debtor_id from debtor_arrears ar where 1=1 and not exists( select 1 from mission m where m.mission_asset_id = ar.asset_id and(m.assigned_sys_user_id is not null or m.assigned_group_id is not null)) and ar.inner_outer = 'inner' and ar.status = 'repay' and ar.asset_type='现金贷多期' and ar.late_days between 7 and 7 and exists(select 1 from asset a where a.asset_id = ar.asset_id and a.asset_from_app = '草莓') and exists(select 1 from debtor_asset da left join asset_quality aq on da.asset_item_number = aq.asset_item_number where da.debtor_arrears_id = ar.id and aq.item_cust_flg = '新用户') and exists(select 1 from debtor_asset da left join c_card cc on da.asset_item_number = cc.asset_item_number where da.debtor_arrears_id = ar.id and cc.d3_level = 1)，unassigned_case_info=[{'debtor_id': 3342339}, {'debtor_id': 3342340}, {'debtor_id': 3342341}, {'debtor_id': 3342342}, {'debtor_id': 3342343}, {'debtor_id': 3342344}, {'debtor_id': 3342345}, {'debtor_id': 3342346}, {'debtor_id': 3342347}, {'debtor_id': 3342348}]
2023-05-06 18:56:03 INFO log_info: #### 当前未分案D1债务数：10
2023-05-06 18:56:06 INFO log_info: 数据尚未准备完成，等待中，等待时间：11
2023-05-06 18:56:06 INFO do_sql: {'db': 'qsq_fox1', 'sql request': " select ar.debtor_id from debtor_arrears ar where 1=1 and not exists( select 1 from mission m where m.mission_asset_id = ar.asset_id and(m.assigned_sys_user_id is not null or m.assigned_group_id is not null)) and ar.inner_outer = 'inner' and ar.status = 'repay' and ar.asset_type='现金贷多期' and ar.late_days between 7 and 7 and exists(select 1 from asset a where a.asset_id = ar.asset_id and a.asset_from_app = '草莓') and exists(select 1 from debtor_asset da left join asset_quality aq on da.asset_item_number = aq.asset_item_number where da.debtor_arrears_id = ar.id and aq.item_cust_flg = '新用户') and exists(select 1 from debtor_asset da left join c_card cc on da.asset_item_number = cc.asset_item_number where da.debtor_arrears_id = ar.id and cc.d3_level = 1)", 'sql time': 0.07}
2023-05-06 18:56:06 INFO log_info: 获取未分案债务数量,SQL= select ar.debtor_id from debtor_arrears ar where 1=1 and not exists( select 1 from mission m where m.mission_asset_id = ar.asset_id and(m.assigned_sys_user_id is not null or m.assigned_group_id is not null)) and ar.inner_outer = 'inner' and ar.status = 'repay' and ar.asset_type='现金贷多期' and ar.late_days between 7 and 7 and exists(select 1 from asset a where a.asset_id = ar.asset_id and a.asset_from_app = '草莓') and exists(select 1 from debtor_asset da left join asset_quality aq on da.asset_item_number = aq.asset_item_number where da.debtor_arrears_id = ar.id and aq.item_cust_flg = '新用户') and exists(select 1 from debtor_asset da left join c_card cc on da.asset_item_number = cc.asset_item_number where da.debtor_arrears_id = ar.id and cc.d3_level = 1)，unassigned_case_info=[{'debtor_id': 3342339}, {'debtor_id': 3342340}, {'debtor_id': 3342341}, {'debtor_id': 3342342}, {'debtor_id': 3342343}, {'debtor_id': 3342344}, {'debtor_id': 3342345}, {'debtor_id': 3342346}, {'debtor_id': 3342347}, {'debtor_id': 3342348}, {'debtor_id': 3342349}]
2023-05-06 18:56:06 INFO log_info: #### 当前未分案D1债务数：11
2023-05-06 18:56:08 INFO log_info: 数据尚未准备完成，等待中，等待时间：12
2023-05-06 18:56:08 INFO do_sql: {'db': 'qsq_fox1', 'sql request': " select ar.debtor_id from debtor_arrears ar where 1=1 and not exists( select 1 from mission m where m.mission_asset_id = ar.asset_id and(m.assigned_sys_user_id is not null or m.assigned_group_id is not null)) and ar.inner_outer = 'inner' and ar.status = 'repay' and ar.asset_type='现金贷多期' and ar.late_days between 7 and 7 and exists(select 1 from asset a where a.asset_id = ar.asset_id and a.asset_from_app = '草莓') and exists(select 1 from debtor_asset da left join asset_quality aq on da.asset_item_number = aq.asset_item_number where da.debtor_arrears_id = ar.id and aq.item_cust_flg = '新用户') and exists(select 1 from debtor_asset da left join c_card cc on da.asset_item_number = cc.asset_item_number where da.debtor_arrears_id = ar.id and cc.d3_level = 1)", 'sql time': 0.15}
2023-05-06 18:56:08 INFO log_info: 获取未分案债务数量,SQL= select ar.debtor_id from debtor_arrears ar where 1=1 and not exists( select 1 from mission m where m.mission_asset_id = ar.asset_id and(m.assigned_sys_user_id is not null or m.assigned_group_id is not null)) and ar.inner_outer = 'inner' and ar.status = 'repay' and ar.asset_type='现金贷多期' and ar.late_days between 7 and 7 and exists(select 1 from asset a where a.asset_id = ar.asset_id and a.asset_from_app = '草莓') and exists(select 1 from debtor_asset da left join asset_quality aq on da.asset_item_number = aq.asset_item_number where da.debtor_arrears_id = ar.id and aq.item_cust_flg = '新用户') and exists(select 1 from debtor_asset da left join c_card cc on da.asset_item_number = cc.asset_item_number where da.debtor_arrears_id = ar.id and cc.d3_level = 1)，unassigned_case_info=[{'debtor_id': 3342339}, {'debtor_id': 3342340}, {'debtor_id': 3342341}, {'debtor_id': 3342342}, {'debtor_id': 3342343}, {'debtor_id': 3342344}, {'debtor_id': 3342345}, {'debtor_id': 3342346}, {'debtor_id': 3342347}, {'debtor_id': 3342348}, {'debtor_id': 3342349}, {'debtor_id': 3342350}]
2023-05-06 18:56:08 INFO log_info: #### 当前未分案D1债务数：12
2023-05-06 18:56:11 INFO log_info: 数据尚未准备完成，等待中，等待时间：13
2023-05-06 18:56:11 INFO do_sql: {'db': 'qsq_fox1', 'sql request': " select ar.debtor_id from debtor_arrears ar where 1=1 and not exists( select 1 from mission m where m.mission_asset_id = ar.asset_id and(m.assigned_sys_user_id is not null or m.assigned_group_id is not null)) and ar.inner_outer = 'inner' and ar.status = 'repay' and ar.asset_type='现金贷多期' and ar.late_days between 7 and 7 and exists(select 1 from asset a where a.asset_id = ar.asset_id and a.asset_from_app = '草莓') and exists(select 1 from debtor_asset da left join asset_quality aq on da.asset_item_number = aq.asset_item_number where da.debtor_arrears_id = ar.id and aq.item_cust_flg = '新用户') and exists(select 1 from debtor_asset da left join c_card cc on da.asset_item_number = cc.asset_item_number where da.debtor_arrears_id = ar.id and cc.d3_level = 1)", 'sql time': 0.06}
2023-05-06 18:56:11 INFO log_info: 获取未分案债务数量,SQL= select ar.debtor_id from debtor_arrears ar where 1=1 and not exists( select 1 from mission m where m.mission_asset_id = ar.asset_id and(m.assigned_sys_user_id is not null or m.assigned_group_id is not null)) and ar.inner_outer = 'inner' and ar.status = 'repay' and ar.asset_type='现金贷多期' and ar.late_days between 7 and 7 and exists(select 1 from asset a where a.asset_id = ar.asset_id and a.asset_from_app = '草莓') and exists(select 1 from debtor_asset da left join asset_quality aq on da.asset_item_number = aq.asset_item_number where da.debtor_arrears_id = ar.id and aq.item_cust_flg = '新用户') and exists(select 1 from debtor_asset da left join c_card cc on da.asset_item_number = cc.asset_item_number where da.debtor_arrears_id = ar.id and cc.d3_level = 1)，unassigned_case_info=[{'debtor_id': 3342339}, {'debtor_id': 3342340}, {'debtor_id': 3342341}, {'debtor_id': 3342342}, {'debtor_id': 3342343}, {'debtor_id': 3342344}, {'debtor_id': 3342345}, {'debtor_id': 3342346}, {'debtor_id': 3342347}, {'debtor_id': 3342348}, {'debtor_id': 3342349}, {'debtor_id': 3342350}, {'debtor_id': 3342351}]
2023-05-06 18:56:11 INFO log_info: #### 当前未分案D1债务数：13
2023-05-06 18:56:13 INFO log_info: 数据尚未准备完成，等待中，等待时间：14
2023-05-06 18:56:13 INFO do_sql: {'db': 'qsq_fox1', 'sql request': " select ar.debtor_id from debtor_arrears ar where 1=1 and not exists( select 1 from mission m where m.mission_asset_id = ar.asset_id and(m.assigned_sys_user_id is not null or m.assigned_group_id is not null)) and ar.inner_outer = 'inner' and ar.status = 'repay' and ar.asset_type='现金贷多期' and ar.late_days between 7 and 7 and exists(select 1 from asset a where a.asset_id = ar.asset_id and a.asset_from_app = '草莓') and exists(select 1 from debtor_asset da left join asset_quality aq on da.asset_item_number = aq.asset_item_number where da.debtor_arrears_id = ar.id and aq.item_cust_flg = '新用户') and exists(select 1 from debtor_asset da left join c_card cc on da.asset_item_number = cc.asset_item_number where da.debtor_arrears_id = ar.id and cc.d3_level = 1)", 'sql time': 0.04}
2023-05-06 18:56:13 INFO log_info: 获取未分案债务数量,SQL= select ar.debtor_id from debtor_arrears ar where 1=1 and not exists( select 1 from mission m where m.mission_asset_id = ar.asset_id and(m.assigned_sys_user_id is not null or m.assigned_group_id is not null)) and ar.inner_outer = 'inner' and ar.status = 'repay' and ar.asset_type='现金贷多期' and ar.late_days between 7 and 7 and exists(select 1 from asset a where a.asset_id = ar.asset_id and a.asset_from_app = '草莓') and exists(select 1 from debtor_asset da left join asset_quality aq on da.asset_item_number = aq.asset_item_number where da.debtor_arrears_id = ar.id and aq.item_cust_flg = '新用户') and exists(select 1 from debtor_asset da left join c_card cc on da.asset_item_number = cc.asset_item_number where da.debtor_arrears_id = ar.id and cc.d3_level = 1)，unassigned_case_info=[{'debtor_id': 3342339}, {'debtor_id': 3342340}, {'debtor_id': 3342341}, {'debtor_id': 3342342}, {'debtor_id': 3342343}, {'debtor_id': 3342344}, {'debtor_id': 3342345}, {'debtor_id': 3342346}, {'debtor_id': 3342347}, {'debtor_id': 3342348}, {'debtor_id': 3342349}, {'debtor_id': 3342350}, {'debtor_id': 3342351}, {'debtor_id': 3342352}]
2023-05-06 18:56:13 INFO log_info: #### 当前未分案D1债务数：14
2023-05-06 18:56:13 INFO log_info: 数据准备成功，当前未分案D1债务数：14
2023-05-06 18:56:13 INFO do_sql: {'db': 'qsq_fox1', 'sql request': "update sys_session_log set stop_time = now() where sys_user_name = 'yxj' and active = 1 and stop_time is null and date_add(start_time, interval time_out/1000 second) > now()", 'sql time': 0.13}
2023-05-06 18:56:13 INFO do_sql: {'db': 'qsq_fox1', 'sql request': "select * from sys_session_log where sys_user_name = 'yxj' and active = 1 and stop_time is null and date_add(start_time, interval time_out/1000 second) > now() order by create_at desc limit 1", 'sql time': 0.06}
2023-05-06 18:56:14 INFO log_info: 登录中，等待时间：1
2023-05-06 18:56:15 INFO log_info: <Response [200]>
2023-05-06 18:56:15 INFO log_info: <Response [200]>
2023-05-06 18:56:15 INFO do_sql: {'db': 'qsq_fox1', 'sql request': "select * from sys_session_log where sys_user_name = 'yxj' and active = 1 and stop_time is null and date_add(start_time, interval time_out/1000 second) > now() order by create_at desc limit 1", 'sql time': 0.25}
2023-05-06 18:56:15 INFO log_info: #### 开始调用fox quartz任务
2023-05-06 18:56:15 INFO log_info: #### 调用quartz任务的时间=2023-05-06 18:56:15
2023-05-06 18:56:15 INFO log_info: 请求报错，url:https://fox-test1.test.k8s-ingress-nginx.kuainiujinke.com/a/schedule/startnow?jobGroup=MISSION_STRATEGY&jobName=newAT_AvgAmountByMonthAssignedAmount 返回的http_code:500异常，返回body:{"timestamp":"2023-05-06 18:56:15","status":500,"error":"Internal Server Error","exception":"java.lang.IllegalStateException","message":"java.lang.NullPointerException","path":"/a/login"}，请检查
2023-05-06 18:56:16 INFO close_connects: 关闭数据库链接：qsq_fox1
2023-05-06 18:59:02 INFO log_info: #### 当前环境env=1，country=china，environment=test
2023-05-06 18:59:02 INFO log_info: 修改未分案的案件天数为99,sql=UPDATE debtor_arrears ar SET ar.late_days = 99 WHERE 1=1 AND NOT exists(SELECT 1 FROM mission m WHERE m.mission_asset_id = ar.asset_id AND (m.assigned_sys_user_id is NOT null OR m.assigned_group_id is NOT null))AND ar.inner_outer = 'inner' AND ar.status = 'repay' AND ar.asset_type='现金贷多期' AND ar.late_days BETWEEN 7 AND 7
2023-05-06 18:59:02 INFO log_info: connect to qsq_fox1 with port 3321
2023-05-06 18:59:02 INFO do_sql: {'db': 'qsq_fox1', 'sql request': "UPDATE debtor_arrears ar SET ar.late_days = 99 WHERE 1=1 AND NOT exists(SELECT 1 FROM mission m WHERE m.mission_asset_id = ar.asset_id AND (m.assigned_sys_user_id is NOT null OR m.assigned_group_id is NOT null))AND ar.inner_outer = 'inner' AND ar.status = 'repay' AND ar.asset_type='现金贷多期' AND ar.late_days BETWEEN 7 AND 7", 'sql time': 0.49}
2023-05-06 18:59:03 INFO do_sql: {'db': 'qsq_fox1', 'sql request': "SELECT su.id FROM asset_type_group a LEFT JOIN user_asset_type b ON b.asset_group_id = a.asset_group LEFT JOIN sys_user su ON b.sys_user_id = su.id LEFT JOIN sys_user_role d ON d.user_id = su.id LEFT JOIN sys_role ee ON d.role_id = ee.id WHERE asset_line_status = 1 AND a.asset_group_name IN ('自动化测试_IVR组') AND su.del_flag=0 AND ee.enname = 'urger'", 'sql time': 0.04}
2023-05-06 18:59:03 INFO do_sql: {'db': 'qsq_fox1', 'sql request': "select sys_user_name as name,assign_total_amount as bf_current_month_assigned_amount from bi.mission_assign_statistics where create_at between date_add(curdate(), interval - day(curdate()) + 1 day) and curdate() and type = 2 and sys_user_id in ('b7715d89b64d4395b202f9dfd91824c6')", 'sql time': 0.06}
2023-05-06 18:59:03 INFO do_sql: {'db': 'qsq_fox1', 'sql request': "select sys_user_name as name,assign_total_amount as bf_current_month_assigned_amount from bi.mission_assign_statistics where create_at between date_add(curdate(), interval - day(curdate()) + 1 day) and curdate() and type = 2 and sys_user_id in ('da84724df241409787b0b14abfcb21e9')", 'sql time': 0.05}
2023-05-06 18:59:03 INFO do_sql: {'db': 'qsq_fox1', 'sql request': "select sys_user_name as name,assign_total_amount as bf_current_month_assigned_amount from bi.mission_assign_statistics where create_at between date_add(curdate(), interval - day(curdate()) + 1 day) and curdate() and type = 2 and sys_user_id in ('cb5be7dbe5644972b5138a28e7201d5d')", 'sql time': 0.04}
2023-05-06 18:59:03 INFO do_sql: {'db': 'qsq_fox1', 'sql request': "SELECT count(*) as online_days FROM collect_attendance_dtl b LEFT JOIN sys_user su ON b.user_id = su.id LEFT JOIN sys_user_role d ON d.user_id = su.id LEFT JOIN sys_role ee ON d.role_id = ee.id WHERE b.attendance_status_flag = 1 AND su.del_flag=0 AND ee.enname = 'urger' and b.work_day >= date_add(curdate(), interval - day(curdate()) + 1 day) and b.work_day <= curdate() and su.name = '八四1' ", 'sql time': 0.2}
2023-05-06 18:59:03 INFO do_sql: {'db': 'qsq_fox1', 'sql request': "SELECT count(*) as online_days FROM collect_attendance_dtl b LEFT JOIN sys_user su ON b.user_id = su.id LEFT JOIN sys_user_role d ON d.user_id = su.id LEFT JOIN sys_role ee ON d.role_id = ee.id WHERE b.attendance_status_flag = 1 AND su.del_flag=0 AND ee.enname = 'urger' and b.work_day >= date_add(curdate(), interval - day(curdate()) + 1 day) and b.work_day <= curdate() and su.name = '八四2' ", 'sql time': 0.06}
2023-05-06 18:59:03 INFO do_sql: {'db': 'qsq_fox1', 'sql request': "SELECT count(*) as online_days FROM collect_attendance_dtl b LEFT JOIN sys_user su ON b.user_id = su.id LEFT JOIN sys_user_role d ON d.user_id = su.id LEFT JOIN sys_role ee ON d.role_id = ee.id WHERE b.attendance_status_flag = 1 AND su.del_flag=0 AND ee.enname = 'urger' and b.work_day >= date_add(curdate(), interval - day(curdate()) + 1 day) and b.work_day <= curdate() and su.name = '八四3' ", 'sql time': 0.04}
2023-05-06 18:59:03 INFO log_info: ### 1分案前 初始化当前已分案情况：pre_assigned_info=  name  bf_current_month_assigned_amount  online_days
0  八四1                         229580960            0
1  八四2                         229019937            0
2  八四3                         228788768            0
2023-05-06 18:59:03 INFO log_info: ### 2分案前 初始化当前已分案情况：pre_assigned_info=  name  ...  assigned_amount/online_days
0  八四1  ...                          0.0
1  八四2  ...                          0.0
2  八四3  ...                          0.0

[3 rows x 4 columns]
2023-05-06 18:59:03 INFO log_info: ### 3分案前 初始化当前已分案情况：pre_assigned_info=  name  ...  assigned_amount/online_days
0  八四1  ...                          0.0
1  八四2  ...                          0.0
2  八四3  ...                          0.0

[3 rows x 4 columns]
2023-05-06 18:59:03 INFO log_info: ### 4分案前 催员排序：expect_assigned_info=  name
0  八四1
1  八四2
2  八四3
2023-05-06 18:59:03 INFO log_info: 需要准备的债务数量=14
2023-05-06 18:59:03 INFO do_sql: {'db': 'qsq_fox1', 'sql request': " select ar.debtor_id from debtor_arrears ar where 1=1 and not exists( select 1 from mission m where m.mission_asset_id = ar.asset_id and(m.assigned_sys_user_id is not null or m.assigned_group_id is not null)) and ar.inner_outer = 'inner' and ar.status = 'repay' and ar.asset_type='现金贷多期' and ar.late_days between 7 and 7 and exists(select 1 from asset a where a.asset_id = ar.asset_id and a.asset_from_app = '草莓') and exists(select 1 from debtor_asset da left join asset_quality aq on da.asset_item_number = aq.asset_item_number where da.debtor_arrears_id = ar.id and aq.item_cust_flg = '新用户') and exists(select 1 from debtor_asset da left join c_card cc on da.asset_item_number = cc.asset_item_number where da.debtor_arrears_id = ar.id and cc.d3_level = 1)", 'sql time': 0.04}
2023-05-06 18:59:03 INFO log_info: 获取未分案债务数量,SQL= select ar.debtor_id from debtor_arrears ar where 1=1 and not exists( select 1 from mission m where m.mission_asset_id = ar.asset_id and(m.assigned_sys_user_id is not null or m.assigned_group_id is not null)) and ar.inner_outer = 'inner' and ar.status = 'repay' and ar.asset_type='现金贷多期' and ar.late_days between 7 and 7 and exists(select 1 from asset a where a.asset_id = ar.asset_id and a.asset_from_app = '草莓') and exists(select 1 from debtor_asset da left join asset_quality aq on da.asset_item_number = aq.asset_item_number where da.debtor_arrears_id = ar.id and aq.item_cust_flg = '新用户') and exists(select 1 from debtor_asset da left join c_card cc on da.asset_item_number = cc.asset_item_number where da.debtor_arrears_id = ar.id and cc.d3_level = 1)，unassigned_case_info=()
2023-05-06 18:59:03 INFO log_info: #### 当前未分案D1债务数：0
2023-05-06 18:59:06 INFO log_info: 数据尚未准备完成，等待中，等待时间：1
2023-05-06 18:59:06 INFO do_sql: {'db': 'qsq_fox1', 'sql request': " select ar.debtor_id from debtor_arrears ar where 1=1 and not exists( select 1 from mission m where m.mission_asset_id = ar.asset_id and(m.assigned_sys_user_id is not null or m.assigned_group_id is not null)) and ar.inner_outer = 'inner' and ar.status = 'repay' and ar.asset_type='现金贷多期' and ar.late_days between 7 and 7 and exists(select 1 from asset a where a.asset_id = ar.asset_id and a.asset_from_app = '草莓') and exists(select 1 from debtor_asset da left join asset_quality aq on da.asset_item_number = aq.asset_item_number where da.debtor_arrears_id = ar.id and aq.item_cust_flg = '新用户') and exists(select 1 from debtor_asset da left join c_card cc on da.asset_item_number = cc.asset_item_number where da.debtor_arrears_id = ar.id and cc.d3_level = 1)", 'sql time': 0.06}
2023-05-06 18:59:06 INFO log_info: 获取未分案债务数量,SQL= select ar.debtor_id from debtor_arrears ar where 1=1 and not exists( select 1 from mission m where m.mission_asset_id = ar.asset_id and(m.assigned_sys_user_id is not null or m.assigned_group_id is not null)) and ar.inner_outer = 'inner' and ar.status = 'repay' and ar.asset_type='现金贷多期' and ar.late_days between 7 and 7 and exists(select 1 from asset a where a.asset_id = ar.asset_id and a.asset_from_app = '草莓') and exists(select 1 from debtor_asset da left join asset_quality aq on da.asset_item_number = aq.asset_item_number where da.debtor_arrears_id = ar.id and aq.item_cust_flg = '新用户') and exists(select 1 from debtor_asset da left join c_card cc on da.asset_item_number = cc.asset_item_number where da.debtor_arrears_id = ar.id and cc.d3_level = 1)，unassigned_case_info=[{'debtor_id': 3342353}]
2023-05-06 18:59:06 INFO log_info: #### 当前未分案D1债务数：1
2023-05-06 18:59:08 INFO log_info: 数据尚未准备完成，等待中，等待时间：2
2023-05-06 18:59:08 INFO do_sql: {'db': 'qsq_fox1', 'sql request': " select ar.debtor_id from debtor_arrears ar where 1=1 and not exists( select 1 from mission m where m.mission_asset_id = ar.asset_id and(m.assigned_sys_user_id is not null or m.assigned_group_id is not null)) and ar.inner_outer = 'inner' and ar.status = 'repay' and ar.asset_type='现金贷多期' and ar.late_days between 7 and 7 and exists(select 1 from asset a where a.asset_id = ar.asset_id and a.asset_from_app = '草莓') and exists(select 1 from debtor_asset da left join asset_quality aq on da.asset_item_number = aq.asset_item_number where da.debtor_arrears_id = ar.id and aq.item_cust_flg = '新用户') and exists(select 1 from debtor_asset da left join c_card cc on da.asset_item_number = cc.asset_item_number where da.debtor_arrears_id = ar.id and cc.d3_level = 1)", 'sql time': 0.03}
2023-05-06 18:59:08 INFO log_info: 获取未分案债务数量,SQL= select ar.debtor_id from debtor_arrears ar where 1=1 and not exists( select 1 from mission m where m.mission_asset_id = ar.asset_id and(m.assigned_sys_user_id is not null or m.assigned_group_id is not null)) and ar.inner_outer = 'inner' and ar.status = 'repay' and ar.asset_type='现金贷多期' and ar.late_days between 7 and 7 and exists(select 1 from asset a where a.asset_id = ar.asset_id and a.asset_from_app = '草莓') and exists(select 1 from debtor_asset da left join asset_quality aq on da.asset_item_number = aq.asset_item_number where da.debtor_arrears_id = ar.id and aq.item_cust_flg = '新用户') and exists(select 1 from debtor_asset da left join c_card cc on da.asset_item_number = cc.asset_item_number where da.debtor_arrears_id = ar.id and cc.d3_level = 1)，unassigned_case_info=[{'debtor_id': 3342353}, {'debtor_id': 3342354}]
2023-05-06 18:59:08 INFO log_info: #### 当前未分案D1债务数：2
2023-05-06 18:59:10 INFO log_info: 数据尚未准备完成，等待中，等待时间：3
2023-05-06 18:59:10 INFO do_sql: {'db': 'qsq_fox1', 'sql request': " select ar.debtor_id from debtor_arrears ar where 1=1 and not exists( select 1 from mission m where m.mission_asset_id = ar.asset_id and(m.assigned_sys_user_id is not null or m.assigned_group_id is not null)) and ar.inner_outer = 'inner' and ar.status = 'repay' and ar.asset_type='现金贷多期' and ar.late_days between 7 and 7 and exists(select 1 from asset a where a.asset_id = ar.asset_id and a.asset_from_app = '草莓') and exists(select 1 from debtor_asset da left join asset_quality aq on da.asset_item_number = aq.asset_item_number where da.debtor_arrears_id = ar.id and aq.item_cust_flg = '新用户') and exists(select 1 from debtor_asset da left join c_card cc on da.asset_item_number = cc.asset_item_number where da.debtor_arrears_id = ar.id and cc.d3_level = 1)", 'sql time': 0.18}
2023-05-06 18:59:10 INFO log_info: 获取未分案债务数量,SQL= select ar.debtor_id from debtor_arrears ar where 1=1 and not exists( select 1 from mission m where m.mission_asset_id = ar.asset_id and(m.assigned_sys_user_id is not null or m.assigned_group_id is not null)) and ar.inner_outer = 'inner' and ar.status = 'repay' and ar.asset_type='现金贷多期' and ar.late_days between 7 and 7 and exists(select 1 from asset a where a.asset_id = ar.asset_id and a.asset_from_app = '草莓') and exists(select 1 from debtor_asset da left join asset_quality aq on da.asset_item_number = aq.asset_item_number where da.debtor_arrears_id = ar.id and aq.item_cust_flg = '新用户') and exists(select 1 from debtor_asset da left join c_card cc on da.asset_item_number = cc.asset_item_number where da.debtor_arrears_id = ar.id and cc.d3_level = 1)，unassigned_case_info=[{'debtor_id': 3342353}, {'debtor_id': 3342354}, {'debtor_id': 3342355}]
2023-05-06 18:59:10 INFO log_info: #### 当前未分案D1债务数：3
2023-05-06 18:59:13 INFO log_info: 数据尚未准备完成，等待中，等待时间：4
2023-05-06 18:59:13 INFO do_sql: {'db': 'qsq_fox1', 'sql request': " select ar.debtor_id from debtor_arrears ar where 1=1 and not exists( select 1 from mission m where m.mission_asset_id = ar.asset_id and(m.assigned_sys_user_id is not null or m.assigned_group_id is not null)) and ar.inner_outer = 'inner' and ar.status = 'repay' and ar.asset_type='现金贷多期' and ar.late_days between 7 and 7 and exists(select 1 from asset a where a.asset_id = ar.asset_id and a.asset_from_app = '草莓') and exists(select 1 from debtor_asset da left join asset_quality aq on da.asset_item_number = aq.asset_item_number where da.debtor_arrears_id = ar.id and aq.item_cust_flg = '新用户') and exists(select 1 from debtor_asset da left join c_card cc on da.asset_item_number = cc.asset_item_number where da.debtor_arrears_id = ar.id and cc.d3_level = 1)", 'sql time': 0.05}
2023-05-06 18:59:13 INFO log_info: 获取未分案债务数量,SQL= select ar.debtor_id from debtor_arrears ar where 1=1 and not exists( select 1 from mission m where m.mission_asset_id = ar.asset_id and(m.assigned_sys_user_id is not null or m.assigned_group_id is not null)) and ar.inner_outer = 'inner' and ar.status = 'repay' and ar.asset_type='现金贷多期' and ar.late_days between 7 and 7 and exists(select 1 from asset a where a.asset_id = ar.asset_id and a.asset_from_app = '草莓') and exists(select 1 from debtor_asset da left join asset_quality aq on da.asset_item_number = aq.asset_item_number where da.debtor_arrears_id = ar.id and aq.item_cust_flg = '新用户') and exists(select 1 from debtor_asset da left join c_card cc on da.asset_item_number = cc.asset_item_number where da.debtor_arrears_id = ar.id and cc.d3_level = 1)，unassigned_case_info=[{'debtor_id': 3342353}, {'debtor_id': 3342354}, {'debtor_id': 3342355}, {'debtor_id': 3342356}]
2023-05-06 18:59:13 INFO log_info: #### 当前未分案D1债务数：4
2023-05-06 18:59:15 INFO log_info: 数据尚未准备完成，等待中，等待时间：5
2023-05-06 18:59:15 INFO do_sql: {'db': 'qsq_fox1', 'sql request': " select ar.debtor_id from debtor_arrears ar where 1=1 and not exists( select 1 from mission m where m.mission_asset_id = ar.asset_id and(m.assigned_sys_user_id is not null or m.assigned_group_id is not null)) and ar.inner_outer = 'inner' and ar.status = 'repay' and ar.asset_type='现金贷多期' and ar.late_days between 7 and 7 and exists(select 1 from asset a where a.asset_id = ar.asset_id and a.asset_from_app = '草莓') and exists(select 1 from debtor_asset da left join asset_quality aq on da.asset_item_number = aq.asset_item_number where da.debtor_arrears_id = ar.id and aq.item_cust_flg = '新用户') and exists(select 1 from debtor_asset da left join c_card cc on da.asset_item_number = cc.asset_item_number where da.debtor_arrears_id = ar.id and cc.d3_level = 1)", 'sql time': 0.06}
2023-05-06 18:59:15 INFO log_info: 获取未分案债务数量,SQL= select ar.debtor_id from debtor_arrears ar where 1=1 and not exists( select 1 from mission m where m.mission_asset_id = ar.asset_id and(m.assigned_sys_user_id is not null or m.assigned_group_id is not null)) and ar.inner_outer = 'inner' and ar.status = 'repay' and ar.asset_type='现金贷多期' and ar.late_days between 7 and 7 and exists(select 1 from asset a where a.asset_id = ar.asset_id and a.asset_from_app = '草莓') and exists(select 1 from debtor_asset da left join asset_quality aq on da.asset_item_number = aq.asset_item_number where da.debtor_arrears_id = ar.id and aq.item_cust_flg = '新用户') and exists(select 1 from debtor_asset da left join c_card cc on da.asset_item_number = cc.asset_item_number where da.debtor_arrears_id = ar.id and cc.d3_level = 1)，unassigned_case_info=[{'debtor_id': 3342353}, {'debtor_id': 3342354}, {'debtor_id': 3342355}, {'debtor_id': 3342356}, {'debtor_id': 3342357}]
2023-05-06 18:59:15 INFO log_info: #### 当前未分案D1债务数：5
2023-05-06 18:59:18 INFO log_info: 数据尚未准备完成，等待中，等待时间：6
2023-05-06 18:59:18 INFO do_sql: {'db': 'qsq_fox1', 'sql request': " select ar.debtor_id from debtor_arrears ar where 1=1 and not exists( select 1 from mission m where m.mission_asset_id = ar.asset_id and(m.assigned_sys_user_id is not null or m.assigned_group_id is not null)) and ar.inner_outer = 'inner' and ar.status = 'repay' and ar.asset_type='现金贷多期' and ar.late_days between 7 and 7 and exists(select 1 from asset a where a.asset_id = ar.asset_id and a.asset_from_app = '草莓') and exists(select 1 from debtor_asset da left join asset_quality aq on da.asset_item_number = aq.asset_item_number where da.debtor_arrears_id = ar.id and aq.item_cust_flg = '新用户') and exists(select 1 from debtor_asset da left join c_card cc on da.asset_item_number = cc.asset_item_number where da.debtor_arrears_id = ar.id and cc.d3_level = 1)", 'sql time': 0.04}
2023-05-06 18:59:18 INFO log_info: 获取未分案债务数量,SQL= select ar.debtor_id from debtor_arrears ar where 1=1 and not exists( select 1 from mission m where m.mission_asset_id = ar.asset_id and(m.assigned_sys_user_id is not null or m.assigned_group_id is not null)) and ar.inner_outer = 'inner' and ar.status = 'repay' and ar.asset_type='现金贷多期' and ar.late_days between 7 and 7 and exists(select 1 from asset a where a.asset_id = ar.asset_id and a.asset_from_app = '草莓') and exists(select 1 from debtor_asset da left join asset_quality aq on da.asset_item_number = aq.asset_item_number where da.debtor_arrears_id = ar.id and aq.item_cust_flg = '新用户') and exists(select 1 from debtor_asset da left join c_card cc on da.asset_item_number = cc.asset_item_number where da.debtor_arrears_id = ar.id and cc.d3_level = 1)，unassigned_case_info=[{'debtor_id': 3342353}, {'debtor_id': 3342354}, {'debtor_id': 3342355}, {'debtor_id': 3342356}, {'debtor_id': 3342357}, {'debtor_id': 3342358}]
2023-05-06 18:59:18 INFO log_info: #### 当前未分案D1债务数：6
2023-05-06 18:59:20 INFO log_info: 数据尚未准备完成，等待中，等待时间：7
2023-05-06 18:59:21 INFO do_sql: {'db': 'qsq_fox1', 'sql request': " select ar.debtor_id from debtor_arrears ar where 1=1 and not exists( select 1 from mission m where m.mission_asset_id = ar.asset_id and(m.assigned_sys_user_id is not null or m.assigned_group_id is not null)) and ar.inner_outer = 'inner' and ar.status = 'repay' and ar.asset_type='现金贷多期' and ar.late_days between 7 and 7 and exists(select 1 from asset a where a.asset_id = ar.asset_id and a.asset_from_app = '草莓') and exists(select 1 from debtor_asset da left join asset_quality aq on da.asset_item_number = aq.asset_item_number where da.debtor_arrears_id = ar.id and aq.item_cust_flg = '新用户') and exists(select 1 from debtor_asset da left join c_card cc on da.asset_item_number = cc.asset_item_number where da.debtor_arrears_id = ar.id and cc.d3_level = 1)", 'sql time': 0.07}
2023-05-06 18:59:21 INFO log_info: 获取未分案债务数量,SQL= select ar.debtor_id from debtor_arrears ar where 1=1 and not exists( select 1 from mission m where m.mission_asset_id = ar.asset_id and(m.assigned_sys_user_id is not null or m.assigned_group_id is not null)) and ar.inner_outer = 'inner' and ar.status = 'repay' and ar.asset_type='现金贷多期' and ar.late_days between 7 and 7 and exists(select 1 from asset a where a.asset_id = ar.asset_id and a.asset_from_app = '草莓') and exists(select 1 from debtor_asset da left join asset_quality aq on da.asset_item_number = aq.asset_item_number where da.debtor_arrears_id = ar.id and aq.item_cust_flg = '新用户') and exists(select 1 from debtor_asset da left join c_card cc on da.asset_item_number = cc.asset_item_number where da.debtor_arrears_id = ar.id and cc.d3_level = 1)，unassigned_case_info=[{'debtor_id': 3342353}, {'debtor_id': 3342354}, {'debtor_id': 3342355}, {'debtor_id': 3342356}, {'debtor_id': 3342357}, {'debtor_id': 3342358}, {'debtor_id': 3342359}]
2023-05-06 18:59:21 INFO log_info: #### 当前未分案D1债务数：7
2023-05-06 18:59:23 INFO log_info: 数据尚未准备完成，等待中，等待时间：8
2023-05-06 18:59:23 INFO do_sql: {'db': 'qsq_fox1', 'sql request': " select ar.debtor_id from debtor_arrears ar where 1=1 and not exists( select 1 from mission m where m.mission_asset_id = ar.asset_id and(m.assigned_sys_user_id is not null or m.assigned_group_id is not null)) and ar.inner_outer = 'inner' and ar.status = 'repay' and ar.asset_type='现金贷多期' and ar.late_days between 7 and 7 and exists(select 1 from asset a where a.asset_id = ar.asset_id and a.asset_from_app = '草莓') and exists(select 1 from debtor_asset da left join asset_quality aq on da.asset_item_number = aq.asset_item_number where da.debtor_arrears_id = ar.id and aq.item_cust_flg = '新用户') and exists(select 1 from debtor_asset da left join c_card cc on da.asset_item_number = cc.asset_item_number where da.debtor_arrears_id = ar.id and cc.d3_level = 1)", 'sql time': 0.05}
2023-05-06 18:59:23 INFO log_info: 获取未分案债务数量,SQL= select ar.debtor_id from debtor_arrears ar where 1=1 and not exists( select 1 from mission m where m.mission_asset_id = ar.asset_id and(m.assigned_sys_user_id is not null or m.assigned_group_id is not null)) and ar.inner_outer = 'inner' and ar.status = 'repay' and ar.asset_type='现金贷多期' and ar.late_days between 7 and 7 and exists(select 1 from asset a where a.asset_id = ar.asset_id and a.asset_from_app = '草莓') and exists(select 1 from debtor_asset da left join asset_quality aq on da.asset_item_number = aq.asset_item_number where da.debtor_arrears_id = ar.id and aq.item_cust_flg = '新用户') and exists(select 1 from debtor_asset da left join c_card cc on da.asset_item_number = cc.asset_item_number where da.debtor_arrears_id = ar.id and cc.d3_level = 1)，unassigned_case_info=[{'debtor_id': 3342353}, {'debtor_id': 3342354}, {'debtor_id': 3342355}, {'debtor_id': 3342356}, {'debtor_id': 3342357}, {'debtor_id': 3342358}, {'debtor_id': 3342359}, {'debtor_id': 3342360}]
2023-05-06 18:59:23 INFO log_info: #### 当前未分案D1债务数：8
2023-05-06 18:59:26 INFO log_info: 数据尚未准备完成，等待中，等待时间：9
2023-05-06 18:59:26 INFO do_sql: {'db': 'qsq_fox1', 'sql request': " select ar.debtor_id from debtor_arrears ar where 1=1 and not exists( select 1 from mission m where m.mission_asset_id = ar.asset_id and(m.assigned_sys_user_id is not null or m.assigned_group_id is not null)) and ar.inner_outer = 'inner' and ar.status = 'repay' and ar.asset_type='现金贷多期' and ar.late_days between 7 and 7 and exists(select 1 from asset a where a.asset_id = ar.asset_id and a.asset_from_app = '草莓') and exists(select 1 from debtor_asset da left join asset_quality aq on da.asset_item_number = aq.asset_item_number where da.debtor_arrears_id = ar.id and aq.item_cust_flg = '新用户') and exists(select 1 from debtor_asset da left join c_card cc on da.asset_item_number = cc.asset_item_number where da.debtor_arrears_id = ar.id and cc.d3_level = 1)", 'sql time': 0.04}
2023-05-06 18:59:26 INFO log_info: 获取未分案债务数量,SQL= select ar.debtor_id from debtor_arrears ar where 1=1 and not exists( select 1 from mission m where m.mission_asset_id = ar.asset_id and(m.assigned_sys_user_id is not null or m.assigned_group_id is not null)) and ar.inner_outer = 'inner' and ar.status = 'repay' and ar.asset_type='现金贷多期' and ar.late_days between 7 and 7 and exists(select 1 from asset a where a.asset_id = ar.asset_id and a.asset_from_app = '草莓') and exists(select 1 from debtor_asset da left join asset_quality aq on da.asset_item_number = aq.asset_item_number where da.debtor_arrears_id = ar.id and aq.item_cust_flg = '新用户') and exists(select 1 from debtor_asset da left join c_card cc on da.asset_item_number = cc.asset_item_number where da.debtor_arrears_id = ar.id and cc.d3_level = 1)，unassigned_case_info=[{'debtor_id': 3342353}, {'debtor_id': 3342354}, {'debtor_id': 3342355}, {'debtor_id': 3342356}, {'debtor_id': 3342357}, {'debtor_id': 3342358}, {'debtor_id': 3342359}, {'debtor_id': 3342360}, {'debtor_id': 3342361}]
2023-05-06 18:59:26 INFO log_info: #### 当前未分案D1债务数：9
2023-05-06 18:59:28 INFO log_info: 数据尚未准备完成，等待中，等待时间：10
2023-05-06 18:59:28 INFO do_sql: {'db': 'qsq_fox1', 'sql request': " select ar.debtor_id from debtor_arrears ar where 1=1 and not exists( select 1 from mission m where m.mission_asset_id = ar.asset_id and(m.assigned_sys_user_id is not null or m.assigned_group_id is not null)) and ar.inner_outer = 'inner' and ar.status = 'repay' and ar.asset_type='现金贷多期' and ar.late_days between 7 and 7 and exists(select 1 from asset a where a.asset_id = ar.asset_id and a.asset_from_app = '草莓') and exists(select 1 from debtor_asset da left join asset_quality aq on da.asset_item_number = aq.asset_item_number where da.debtor_arrears_id = ar.id and aq.item_cust_flg = '新用户') and exists(select 1 from debtor_asset da left join c_card cc on da.asset_item_number = cc.asset_item_number where da.debtor_arrears_id = ar.id and cc.d3_level = 1)", 'sql time': 0.06}
2023-05-06 18:59:28 INFO log_info: 获取未分案债务数量,SQL= select ar.debtor_id from debtor_arrears ar where 1=1 and not exists( select 1 from mission m where m.mission_asset_id = ar.asset_id and(m.assigned_sys_user_id is not null or m.assigned_group_id is not null)) and ar.inner_outer = 'inner' and ar.status = 'repay' and ar.asset_type='现金贷多期' and ar.late_days between 7 and 7 and exists(select 1 from asset a where a.asset_id = ar.asset_id and a.asset_from_app = '草莓') and exists(select 1 from debtor_asset da left join asset_quality aq on da.asset_item_number = aq.asset_item_number where da.debtor_arrears_id = ar.id and aq.item_cust_flg = '新用户') and exists(select 1 from debtor_asset da left join c_card cc on da.asset_item_number = cc.asset_item_number where da.debtor_arrears_id = ar.id and cc.d3_level = 1)，unassigned_case_info=[{'debtor_id': 3342353}, {'debtor_id': 3342354}, {'debtor_id': 3342355}, {'debtor_id': 3342356}, {'debtor_id': 3342357}, {'debtor_id': 3342358}, {'debtor_id': 3342359}, {'debtor_id': 3342360}, {'debtor_id': 3342361}, {'debtor_id': 3342362}]
2023-05-06 18:59:28 INFO log_info: #### 当前未分案D1债务数：10
2023-05-06 18:59:31 INFO log_info: 数据尚未准备完成，等待中，等待时间：11
2023-05-06 18:59:31 INFO do_sql: {'db': 'qsq_fox1', 'sql request': " select ar.debtor_id from debtor_arrears ar where 1=1 and not exists( select 1 from mission m where m.mission_asset_id = ar.asset_id and(m.assigned_sys_user_id is not null or m.assigned_group_id is not null)) and ar.inner_outer = 'inner' and ar.status = 'repay' and ar.asset_type='现金贷多期' and ar.late_days between 7 and 7 and exists(select 1 from asset a where a.asset_id = ar.asset_id and a.asset_from_app = '草莓') and exists(select 1 from debtor_asset da left join asset_quality aq on da.asset_item_number = aq.asset_item_number where da.debtor_arrears_id = ar.id and aq.item_cust_flg = '新用户') and exists(select 1 from debtor_asset da left join c_card cc on da.asset_item_number = cc.asset_item_number where da.debtor_arrears_id = ar.id and cc.d3_level = 1)", 'sql time': 0.04}
2023-05-06 18:59:31 INFO log_info: 获取未分案债务数量,SQL= select ar.debtor_id from debtor_arrears ar where 1=1 and not exists( select 1 from mission m where m.mission_asset_id = ar.asset_id and(m.assigned_sys_user_id is not null or m.assigned_group_id is not null)) and ar.inner_outer = 'inner' and ar.status = 'repay' and ar.asset_type='现金贷多期' and ar.late_days between 7 and 7 and exists(select 1 from asset a where a.asset_id = ar.asset_id and a.asset_from_app = '草莓') and exists(select 1 from debtor_asset da left join asset_quality aq on da.asset_item_number = aq.asset_item_number where da.debtor_arrears_id = ar.id and aq.item_cust_flg = '新用户') and exists(select 1 from debtor_asset da left join c_card cc on da.asset_item_number = cc.asset_item_number where da.debtor_arrears_id = ar.id and cc.d3_level = 1)，unassigned_case_info=[{'debtor_id': 3342353}, {'debtor_id': 3342354}, {'debtor_id': 3342355}, {'debtor_id': 3342356}, {'debtor_id': 3342357}, {'debtor_id': 3342358}, {'debtor_id': 3342359}, {'debtor_id': 3342360}, {'debtor_id': 3342361}, {'debtor_id': 3342362}, {'debtor_id': 3342363}]
2023-05-06 18:59:31 INFO log_info: #### 当前未分案D1债务数：11
2023-05-06 18:59:33 INFO log_info: 数据尚未准备完成，等待中，等待时间：12
2023-05-06 18:59:33 INFO do_sql: {'db': 'qsq_fox1', 'sql request': " select ar.debtor_id from debtor_arrears ar where 1=1 and not exists( select 1 from mission m where m.mission_asset_id = ar.asset_id and(m.assigned_sys_user_id is not null or m.assigned_group_id is not null)) and ar.inner_outer = 'inner' and ar.status = 'repay' and ar.asset_type='现金贷多期' and ar.late_days between 7 and 7 and exists(select 1 from asset a where a.asset_id = ar.asset_id and a.asset_from_app = '草莓') and exists(select 1 from debtor_asset da left join asset_quality aq on da.asset_item_number = aq.asset_item_number where da.debtor_arrears_id = ar.id and aq.item_cust_flg = '新用户') and exists(select 1 from debtor_asset da left join c_card cc on da.asset_item_number = cc.asset_item_number where da.debtor_arrears_id = ar.id and cc.d3_level = 1)", 'sql time': 0.22}
2023-05-06 18:59:33 INFO log_info: 获取未分案债务数量,SQL= select ar.debtor_id from debtor_arrears ar where 1=1 and not exists( select 1 from mission m where m.mission_asset_id = ar.asset_id and(m.assigned_sys_user_id is not null or m.assigned_group_id is not null)) and ar.inner_outer = 'inner' and ar.status = 'repay' and ar.asset_type='现金贷多期' and ar.late_days between 7 and 7 and exists(select 1 from asset a where a.asset_id = ar.asset_id and a.asset_from_app = '草莓') and exists(select 1 from debtor_asset da left join asset_quality aq on da.asset_item_number = aq.asset_item_number where da.debtor_arrears_id = ar.id and aq.item_cust_flg = '新用户') and exists(select 1 from debtor_asset da left join c_card cc on da.asset_item_number = cc.asset_item_number where da.debtor_arrears_id = ar.id and cc.d3_level = 1)，unassigned_case_info=[{'debtor_id': 3342353}, {'debtor_id': 3342354}, {'debtor_id': 3342355}, {'debtor_id': 3342356}, {'debtor_id': 3342357}, {'debtor_id': 3342358}, {'debtor_id': 3342359}, {'debtor_id': 3342360}, {'debtor_id': 3342361}, {'debtor_id': 3342362}, {'debtor_id': 3342363}, {'debtor_id': 3342364}]
2023-05-06 18:59:33 INFO log_info: #### 当前未分案D1债务数：12
2023-05-06 18:59:36 INFO log_info: 数据尚未准备完成，等待中，等待时间：13
2023-05-06 18:59:36 INFO do_sql: {'db': 'qsq_fox1', 'sql request': " select ar.debtor_id from debtor_arrears ar where 1=1 and not exists( select 1 from mission m where m.mission_asset_id = ar.asset_id and(m.assigned_sys_user_id is not null or m.assigned_group_id is not null)) and ar.inner_outer = 'inner' and ar.status = 'repay' and ar.asset_type='现金贷多期' and ar.late_days between 7 and 7 and exists(select 1 from asset a where a.asset_id = ar.asset_id and a.asset_from_app = '草莓') and exists(select 1 from debtor_asset da left join asset_quality aq on da.asset_item_number = aq.asset_item_number where da.debtor_arrears_id = ar.id and aq.item_cust_flg = '新用户') and exists(select 1 from debtor_asset da left join c_card cc on da.asset_item_number = cc.asset_item_number where da.debtor_arrears_id = ar.id and cc.d3_level = 1)", 'sql time': 0.07}
2023-05-06 18:59:36 INFO log_info: 获取未分案债务数量,SQL= select ar.debtor_id from debtor_arrears ar where 1=1 and not exists( select 1 from mission m where m.mission_asset_id = ar.asset_id and(m.assigned_sys_user_id is not null or m.assigned_group_id is not null)) and ar.inner_outer = 'inner' and ar.status = 'repay' and ar.asset_type='现金贷多期' and ar.late_days between 7 and 7 and exists(select 1 from asset a where a.asset_id = ar.asset_id and a.asset_from_app = '草莓') and exists(select 1 from debtor_asset da left join asset_quality aq on da.asset_item_number = aq.asset_item_number where da.debtor_arrears_id = ar.id and aq.item_cust_flg = '新用户') and exists(select 1 from debtor_asset da left join c_card cc on da.asset_item_number = cc.asset_item_number where da.debtor_arrears_id = ar.id and cc.d3_level = 1)，unassigned_case_info=[{'debtor_id': 3342353}, {'debtor_id': 3342354}, {'debtor_id': 3342355}, {'debtor_id': 3342356}, {'debtor_id': 3342357}, {'debtor_id': 3342358}, {'debtor_id': 3342359}, {'debtor_id': 3342360}, {'debtor_id': 3342361}, {'debtor_id': 3342362}, {'debtor_id': 3342363}, {'debtor_id': 3342364}, {'debtor_id': 3342365}]
2023-05-06 18:59:36 INFO log_info: #### 当前未分案D1债务数：13
2023-05-06 18:59:38 INFO log_info: 数据尚未准备完成，等待中，等待时间：14
2023-05-06 18:59:38 INFO do_sql: {'db': 'qsq_fox1', 'sql request': " select ar.debtor_id from debtor_arrears ar where 1=1 and not exists( select 1 from mission m where m.mission_asset_id = ar.asset_id and(m.assigned_sys_user_id is not null or m.assigned_group_id is not null)) and ar.inner_outer = 'inner' and ar.status = 'repay' and ar.asset_type='现金贷多期' and ar.late_days between 7 and 7 and exists(select 1 from asset a where a.asset_id = ar.asset_id and a.asset_from_app = '草莓') and exists(select 1 from debtor_asset da left join asset_quality aq on da.asset_item_number = aq.asset_item_number where da.debtor_arrears_id = ar.id and aq.item_cust_flg = '新用户') and exists(select 1 from debtor_asset da left join c_card cc on da.asset_item_number = cc.asset_item_number where da.debtor_arrears_id = ar.id and cc.d3_level = 1)", 'sql time': 0.06}
2023-05-06 18:59:38 INFO log_info: 获取未分案债务数量,SQL= select ar.debtor_id from debtor_arrears ar where 1=1 and not exists( select 1 from mission m where m.mission_asset_id = ar.asset_id and(m.assigned_sys_user_id is not null or m.assigned_group_id is not null)) and ar.inner_outer = 'inner' and ar.status = 'repay' and ar.asset_type='现金贷多期' and ar.late_days between 7 and 7 and exists(select 1 from asset a where a.asset_id = ar.asset_id and a.asset_from_app = '草莓') and exists(select 1 from debtor_asset da left join asset_quality aq on da.asset_item_number = aq.asset_item_number where da.debtor_arrears_id = ar.id and aq.item_cust_flg = '新用户') and exists(select 1 from debtor_asset da left join c_card cc on da.asset_item_number = cc.asset_item_number where da.debtor_arrears_id = ar.id and cc.d3_level = 1)，unassigned_case_info=[{'debtor_id': 3342353}, {'debtor_id': 3342354}, {'debtor_id': 3342355}, {'debtor_id': 3342356}, {'debtor_id': 3342357}, {'debtor_id': 3342358}, {'debtor_id': 3342359}, {'debtor_id': 3342360}, {'debtor_id': 3342361}, {'debtor_id': 3342362}, {'debtor_id': 3342363}, {'debtor_id': 3342364}, {'debtor_id': 3342365}, {'debtor_id': 3342366}]
2023-05-06 18:59:38 INFO log_info: #### 当前未分案D1债务数：14
2023-05-06 18:59:38 INFO log_info: 数据准备成功，当前未分案D1债务数：14
2023-05-06 18:59:38 INFO do_sql: {'db': 'qsq_fox1', 'sql request': "update sys_session_log set stop_time = now(),active = 0,stopped=1 where sys_user_name = 'yxj' and active = 1 and stop_time is null and date_add(start_time, interval time_out/1000 second) > now()", 'sql time': 0.06}
2023-05-06 18:59:38 INFO do_sql: {'db': 'qsq_fox1', 'sql request': "select * from sys_session_log where sys_user_name = 'yxj' and active = 1 and stop_time is null and date_add(start_time, interval time_out/1000 second) > now() order by create_at desc limit 1", 'sql time': 0.04}
2023-05-06 18:59:39 INFO log_info: 登录中，等待时间：1
2023-05-06 18:59:39 INFO log_info: <Response [200]>
2023-05-06 18:59:40 INFO log_info: <Response [200]>
2023-05-06 18:59:40 INFO do_sql: {'db': 'qsq_fox1', 'sql request': "select * from sys_session_log where sys_user_name = 'yxj' and active = 1 and stop_time is null and date_add(start_time, interval time_out/1000 second) > now() order by create_at desc limit 1", 'sql time': 0.06}
2023-05-06 18:59:40 INFO log_info: #### 开始调用fox quartz任务
2023-05-06 18:59:40 INFO log_info: #### 调用quartz任务的时间=2023-05-06 18:59:40
2023-05-06 18:59:40 INFO log_info: 请求报错，url:https://fox-test1.test.k8s-ingress-nginx.kuainiujinke.com/a/schedule/startnow?jobGroup=MISSION_STRATEGY&jobName=newAT_AvgAmountByMonthAssignedAmount 返回的http_code:500异常，返回body:{"timestamp":"2023-05-06 18:59:40","status":500,"error":"Internal Server Error","exception":"java.lang.IllegalStateException","message":"java.lang.NullPointerException","path":"/a/login"}，请检查
2023-05-06 18:59:40 INFO close_connects: 关闭数据库链接：qsq_fox1
